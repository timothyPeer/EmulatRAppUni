<!DOCTYPE html>
<html>
<head>
   <title>PTE</title>
   <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />   
   <meta http-equiv="X-UA-Compatible" content="IE=edge" />
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta name="description" content="# SMP-Coherent PTE Interface - Integration Guide &nbsp;## Overview &nbsp;This interface provides **per-CPU SPAM caches** with **SMP coherence** following your established `global_xxx(cpu" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <link type="text/css" href="custom.css" rel="stylesheet" />

   <style TYPE="text/css" media="screen"> 
      html, body { margin:0; 
        padding:0; 
        background: #ffffff; 
      } 
      div#printheader { display: none; }
      #idheader { 
        width:100%; 
        min-height: 60px; 
        padding: 0; 
        margin: 0;
        position: fixed;
        top: 0;
        background: #F0F0F0;
        z-index: 2;
      } 
      /* The "min-height" for "#idheader table" ensures that the (blue) header of the topic
         has at least the same height as the header of the navigation panel left of it */
      #idheader table { min-height: 59px;}             
      #idheader h1 span { color: #000000 }     
      #idnav {
        text-align: right;
        width: 126px;
        vertical-align: middle;        
      } 
      #idnav a { text-decoration: none }
      #idnav span {
        display: inline-block;
        width: 24px;
        height: 24px;
        margin-left: 4px;
        background:url('hm_webhelp_buttons_white.png') top left no-repeat;
      } 
      #idnav a span {
        background-image:url('hm_webhelp_buttons_grey.png');
      } 
      #idnav a span:hover {
        background-image:url('hm_webhelp_buttons_yellow.png');
      } 
      #idnav span.hmbtnprev { background-position: 0 -32px }
      #idnav span.hmbtnnext { background-position: -24px -32px }
      #idnav span.hmbtntop  { background-position: -48px -32px }
      #idnav span.hmbtntoggle  { width: 20px; background-position: -70px -32px }
      #idnav span.hmbtnprint  { background-position: -88px -32px }

      #callout-table, #overview-table {display:block; position:relative; top:0; left:0;}
      #callout-icon {display:block; position:absolute; top:-11px; left:-11px;}
      #callout-icon-flag {display:block; position:absolute; top:-11px; left:-8px;}
      #callout-table a {text-decoration: none; color: blue;}
      #callout-table a:visited {text-decoration: none; color: blue;}
      #overview-table a {text-decoration: none; color: black;}
      #overview-table a:visited {text-decoration: none; color: black;}
      #callout-table a:hover, #overview-table a:hover {text-decoration: underline;}       
      p.help-url { margin: 20px 0 5px 0; text-align: center; }
	  p.help-url a:link { font-size: 50%; text-decoration: none; color: black; }
	  p.help-url a:visited { color: black; }
	  p.help-url a:hover { font-size: 95%; text-decoration: underline; }
      #switchtoggles { text-align: right; padding: 0 2px 0 0; font-size: 90%; } 
      .sync-toc { color: #000000; font-size: 8pt; font-weight: bold; display: none; }
      .sync-toc a { color: #000000; text-decoration: none; font-weight: bold;}
      .sync-toc a:visited { color: #000000; }
      .sync-toc a:hover { text-decoration: underline; }
	  a#printbuttonlink { cursor: pointer; }
      a.hmanchor { display: inline-block; margin-top: -4em; padding-top: 4em; }  
   </style>
   <style TYPE="text/css" media="print">
      div#idheader, img.dropdown-toggle-icon, p.help-url { display:none } 
   </style>
   
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "pte.html");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body>


<div id="printheader"><h1 class="p_Heading1" style="page-break-after: avoid;"><span class="f_Heading1">PTE</span></h1>
</div>
<div id="idheader">
<div id="idheaderbg">
<table style="width:100%;border:none;margin:0px;" cellspacing="0" cellpadding="0"> 
  <tr>
    <td class="topichead" style="text-align:left; vertical-align:middle">
      <p class="sync-toc">&lt;&lt; <a rel="nofollow" href="index.html?pte.html" target="_top">Click to Display Table of Contents</a> &gt;&gt;</p>
      <p class="crumbs"><b>Navigation:</b>&nbsp;
      &raquo;No topics above this level&laquo;
      </p>
   
      <h1 class="p_Heading1" style="page-break-after: avoid;"><span class="f_Heading1">PTE</span></h1>

    </td>
    <td class="topichead" id="idnav">
      
      <span class="hmbtnprev"></span>
      <a href="appendix---trait-examples.html" title="Parent Chapter"><span class="hmbtntop"></span></a>
      <span class="hmbtnnext"></span>
      
    </td>
  </tr>  
</table>
</div>
</div>  

<div id="idcontent"><div id="innerdiv">
<!-- Ask Internet Explorer 6.users to update their obsolete and dangerous browser --> 
<!--[if lt IE 7]><div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;'><a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode"><img src="http://storage.ie6countdown.com/assets/100/images/banners/warning_bar_0000_us.jpg" border="0" height="42" width="820" alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today." /></a></div><![endif]-->

<!--ZOOMRESTART-->
<p class="p_Normal"># SMP-Coherent PTE Interface - Integration Guide</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">## Overview</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">This interface provides **per-CPU SPAM caches** with **SMP coherence** following your established `global_xxx(cpuId)` naming pattern.</p>
<p class="p_Normal">&nbsp;</p>
<h2 class="p_Heading2" style="page-break-after: avoid;"><span class="f_Heading2">Architecture</span></h2>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">Per-CPU&nbsp;SPAM&nbsp;(Fast&nbsp;Path):</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">┌────────────────────────────────────────┐</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">│&nbsp;&nbsp;CPU&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CPU&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CPU&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CPU&nbsp;3│</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">│&nbsp;&nbsp;┌────┐&nbsp;&nbsp;&nbsp;&nbsp;┌────┐&nbsp;&nbsp;&nbsp;&nbsp;┌────┐&nbsp;&nbsp;&nbsp;&nbsp;┌────┐&nbsp;&nbsp;│</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">│&nbsp;&nbsp;│SPAM│&nbsp;&nbsp;&nbsp;&nbsp;│SPAM│&nbsp;&nbsp;&nbsp;&nbsp;│SPAM│&nbsp;&nbsp;&nbsp;&nbsp;│SPAM│&nbsp;&nbsp;│</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">│&nbsp;&nbsp;│DTB&nbsp;│&nbsp;&nbsp;&nbsp;&nbsp;│DTB&nbsp;│&nbsp;&nbsp;&nbsp;&nbsp;│DTB&nbsp;│&nbsp;&nbsp;&nbsp;&nbsp;│DTB&nbsp;│&nbsp;&nbsp;│</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">│&nbsp;&nbsp;│ITB&nbsp;│&nbsp;&nbsp;&nbsp;&nbsp;│ITB&nbsp;│&nbsp;&nbsp;&nbsp;&nbsp;│ITB&nbsp;│&nbsp;&nbsp;&nbsp;&nbsp;│ITB&nbsp;│&nbsp;&nbsp;│</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">│&nbsp;&nbsp;└────┘&nbsp;&nbsp;&nbsp;&nbsp;└────┘&nbsp;&nbsp;&nbsp;&nbsp;└────┘&nbsp;&nbsp;&nbsp;&nbsp;└────┘&nbsp;&nbsp;│</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">└────────────────────────────────────────┘</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;↓</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">Shared&nbsp;ASN&nbsp;Epochs&nbsp;(Coherence):</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">┌────────────────────────────────────────┐</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">│&nbsp;&nbsp;ASN[0]&nbsp;=&nbsp;gen&nbsp;42&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;│</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">│&nbsp;&nbsp;ASN[1]&nbsp;=&nbsp;gen&nbsp;17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;│</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">│&nbsp;&nbsp;...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;│</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">│&nbsp;&nbsp;ASN[255]&nbsp;=&nbsp;gen&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;│</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">└────────────────────────────────────────┘</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">--</p>
<p class="p_Normal"><span class="f_Heading2">Naming Convention (Follows Your Standard)</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_CodeExample"><span class="f_CodeExample">//&nbsp;IPR&nbsp;access&nbsp;(your&nbsp;existing&nbsp;pattern)</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">globalIPRHot(cpuId)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Per-CPU&nbsp;IPR&nbsp;hot&nbsp;registers</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">globalIPRCold(cpuId)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Per-CPU&nbsp;IPR&nbsp;cold&nbsp;registers</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">//&nbsp;PTE/SPAM&nbsp;access&nbsp;(NEW&nbsp;-&nbsp;matches&nbsp;your&nbsp;pattern)</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">globalSPAM(cpuId)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Per-CPU&nbsp;SPAM&nbsp;manager</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">globalASNEpochs()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Shared&nbsp;ASN&nbsp;epoch&nbsp;table&nbsp;(no&nbsp;CPU&nbsp;ID&nbsp;-&nbsp;shared!)</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">---</p>
<p class="p_Normal">&nbsp;</p>
<h2 class="p_Heading2" style="page-break-after: avoid;"><span class="f_Heading2">## Primary Use Cases</span></h2>
<p class="p_Normal">&nbsp;</p>
<h3 class="p_Heading3" style="page-break-after: avoid;"><span class="f_Heading3"> 1. TLB Lookup (Fast Path - Per-CPU)</span></h3>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">//&nbsp;In&nbsp;translation&nbsp;path&nbsp;(ev6TranslateFastVA)</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">quint64&nbsp;translateVA(CPUIdType&nbsp;cpuId,&nbsp;VAType&nbsp;va,&nbsp;ASNType&nbsp;asn)&nbsp;noexcept</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">{</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Construct&nbsp;tag</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;Ev6TLBTag&nbsp;tag;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;tag.vpn&nbsp;=&nbsp;va&nbsp;&gt;&gt;&nbsp;13;&nbsp;&nbsp;//&nbsp;8KB&nbsp;pages</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;tag.realm&nbsp;=&nbsp;0;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;DTB</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;tag.sizeClass&nbsp;=&nbsp;0;&nbsp;&nbsp;&nbsp;//&nbsp;8KB</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;tag.matchAllASNs&nbsp;=&nbsp;false;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Fast&nbsp;lookup&nbsp;in&nbsp;per-CPU&nbsp;SPAM</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;SPAMEntry&lt;Ev6PTETraits&gt;*&nbsp;entry&nbsp;=&nbsp;retrievePTE(cpuId,&nbsp;tag,&nbsp;asn);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(entry&nbsp;&amp;&amp;&nbsp;entry-&gt;isValid())&nbsp;{</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;HIT&nbsp;-&nbsp;Fast&nbsp;path</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(entry-&gt;pfn&nbsp;&lt;&lt;&nbsp;13)&nbsp;|&nbsp;(va&nbsp;&amp;&nbsp;0x1FFF);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;}</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;MISS&nbsp;-&nbsp;Walk&nbsp;page&nbsp;table</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;walkAndRefill</span>(cpuId,&nbsp;va,&nbsp;asn,&nbsp;tag);</p>
<p class="p_Normal">}</p>
<p class="p_Normal">&nbsp;</p>
<h3 class="p_Heading3" style="page-break-after: avoid;"><span class="f_Heading3"> 2. TLB Refill After Page Table Walk</span></h3>
<h3 class="p_Heading3" style="page-break-after: avoid;"><span class="f_Heading3">&nbsp;</span></h3>
<h3 class="p_Heading3" style="page-break-after: avoid;"><span class="f_Heading3">&nbsp;</span></h3>
<p class="p_CodeExample"><span class="f_CodeExample">quint64&nbsp;walkAndRefill(CPUIdType&nbsp;cpuId,&nbsp;VAType&nbsp;va,&nbsp;ASNType&nbsp;asn,&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;Ev6TLBTag&amp;&nbsp;tag)&nbsp;noexcept</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">{</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Walk&nbsp;page&nbsp;table&nbsp;(slow&nbsp;path)</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;AlphaPTE&nbsp;pte&nbsp;=&nbsp;walkPageTable_EV6(va,&nbsp;ptbr,&nbsp;mode,&nbsp;access,&nbsp;memoryReader);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!pte.valid())&nbsp;{</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Page&nbsp;fault</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raiseTrap(TrapCode::DTB_MISS,&nbsp;va);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;}</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Insert&nbsp;into&nbsp;per-CPU&nbsp;SPAM</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;bool&nbsp;inserted&nbsp;=&nbsp;placePTE(cpuId,&nbsp;tag,&nbsp;pte,&nbsp;asn);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!inserted)&nbsp;{</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;SPAM&nbsp;full&nbsp;-&nbsp;evict&nbsp;something&nbsp;(handled&nbsp;internally&nbsp;by&nbsp;SPAM)</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;}</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Return&nbsp;physical&nbsp;address</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(pte.pfn()&nbsp;&lt;&lt;&nbsp;13)&nbsp;|&nbsp;(va&nbsp;&amp;&nbsp;0x1FFF);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">}</span></p>
<p class="p_Normal">&nbsp;</p>
<h3 class="p_Heading3" style="page-break-after: avoid;"><span class="f_Heading3"> 3. MTPR_ASN - Change ASN (With TLB Flush)</span></h3>
<p class="p_Normal">&nbsp;</p>
<p class="p_CodeExample"><span class="f_CodeExample">void&nbsp;IBox::executeMTPR_ASN(const&nbsp;DecodedInstruction&amp;&nbsp;di)&nbsp;noexcept</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">{</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;auto&amp;&nbsp;iprs&nbsp;=&nbsp;globalIPRHot(m_cpuId);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Read&nbsp;new&nbsp;ASN</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;quint64&nbsp;newAsn&nbsp;=&nbsp;m_ctx-&gt;readIntReg(16)&nbsp;&amp;&nbsp;0xFF;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;quint64&nbsp;oldAsn&nbsp;=&nbsp;iprs.asn;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Write&nbsp;to&nbsp;IPR</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;iprs.asn&nbsp;=&nbsp;newAsn;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(newAsn&nbsp;!=&nbsp;oldAsn)&nbsp;{</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Increment&nbsp;ASN&nbsp;generation&nbsp;(makes&nbsp;old&nbsp;entries&nbsp;stale)</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;quint32&nbsp;newGen&nbsp;=&nbsp;GlobalPTESMP::incrementASNGeneration(oldAsn);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Sweep&nbsp;dead&nbsp;entries&nbsp;on&nbsp;THIS&nbsp;CPU&nbsp;only</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;globalSPAM(m_cpuId).sweepDeadForASN(oldAsn,&nbsp;newGen);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Optional:&nbsp;Full&nbsp;TLB&nbsp;flush&nbsp;for&nbsp;safety</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;globalSPAM(m_cpuId).flushAll();</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;}</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Final&nbsp;step</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;quint64&nbsp;nextPC&nbsp;=&nbsp;m_ctx-&gt;getPC()&nbsp;+&nbsp;4;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;final_stage_before_exit(nextPC);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">}</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<h3 class="p_Heading3" style="page-break-after: avoid;"><span class="f_Heading3"> 4. Page Table Modification (Requires TLB Shootdown)</span></h3>
<h3 class="p_Heading3" style="page-break-after: avoid;"><span class="f_Heading3">&nbsp;</span></h3>
<h3 class="p_Heading3" style="page-break-after: avoid;"><span class="f_Heading3">&nbsp;</span></h3>
<p class="p_CodeExample"><span class="f_CodeExample">void&nbsp;modifyPageTableEntry(VAType&nbsp;va,&nbsp;const&nbsp;AlphaPTE&amp;&nbsp;newPTE,&nbsp;ASNType&nbsp;asn)&nbsp;noexcept</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">{</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Write&nbsp;new&nbsp;PTE&nbsp;to&nbsp;memory</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;quint64&nbsp;ptePa&nbsp;=&nbsp;calculatePTEAddress(va);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;storeMemory(ptePa,&nbsp;8,&nbsp;newPTE.raw);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;CRITICAL:&nbsp;Invalidate&nbsp;on&nbsp;ALL&nbsp;CPUs!</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Other&nbsp;CPUs&nbsp;may&nbsp;have&nbsp;cached&nbsp;the&nbsp;old&nbsp;PTE</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;Ev6TLBTag&nbsp;tag;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;tag.vpn&nbsp;=&nbsp;va&nbsp;&gt;&gt;&nbsp;13;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;tag.realm&nbsp;=&nbsp;0;&nbsp;&nbsp;//&nbsp;DTB</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;tag.sizeClass&nbsp;=&nbsp;0;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;tag.matchAllASNs&nbsp;=&nbsp;false;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;invalidatePTE_AllCPUs(tag,&nbsp;asn);&nbsp;&nbsp;//&nbsp;TLB&nbsp;shootdown&nbsp;(expensive!)</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">}</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_Normal">&nbsp;</p>
<h3 class="p_Heading3" style="page-break-after: avoid;"><span class="f_Heading3"> 5. Process Termination (Flush ASN)</span></h3>
<h3 class="p_Heading3" style="page-break-after: avoid;"><span class="f_Heading3">&nbsp;</span></h3>
<p class="p_CodeExample"><span class="f_CodeExample">void&nbsp;terminateProcess(ASNType&nbsp;asn)&nbsp;noexcept</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">{</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Flush&nbsp;this&nbsp;ASN&nbsp;on&nbsp;ALL&nbsp;CPUs</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;This&nbsp;is&nbsp;safe&nbsp;because&nbsp;no&nbsp;CPU&nbsp;will&nbsp;be&nbsp;running&nbsp;this&nbsp;process&nbsp;anymore</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;GlobalPTESMP::flushASNAllCPUs(asn);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Now&nbsp;ASN&nbsp;can&nbsp;be&nbsp;reassigned&nbsp;to&nbsp;a&nbsp;new&nbsp;process</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">}</span></p>
<p class="p_Normal">&nbsp;</p>
<h3 class="p_Heading3" style="page-break-after: avoid;"><span class="f_Heading3"> 6. Context Switch (Simple Local Flush)</span></h3>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">void&nbsp;contextSwitch(CPUIdType&nbsp;cpuId,&nbsp;ASNType&nbsp;oldAsn,&nbsp;ASNType&nbsp;newAsn)&nbsp;noexcept</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">{</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Update&nbsp;ASN&nbsp;in&nbsp;IPR</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;globalIPRHot(cpuId).asn&nbsp;=&nbsp;newAsn;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Option&nbsp;A:&nbsp;Sweep&nbsp;dead&nbsp;entries&nbsp;for&nbsp;old&nbsp;ASN&nbsp;(fast)</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;quint32&nbsp;newGen&nbsp;=&nbsp;GlobalPTESMP::getASNGeneration(oldAsn);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;globalSPAM(cpuId).sweepDeadForASN(oldAsn,&nbsp;newGen);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Option&nbsp;B:&nbsp;Full&nbsp;local&nbsp;flush&nbsp;(safer&nbsp;but&nbsp;slower)</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;GlobalPTESMP::flushCPU(cpuId);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">}</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">---</p>
<p class="p_Normal">&nbsp;</p>
<h2 class="p_Heading2" style="page-break-after: avoid;"><span class="f_Heading2">## Initialization</span></h2>
<p class="p_Normal">&nbsp;</p>
<p class="p_CodeExample"><span class="f_CodeExample">//&nbsp;In&nbsp;main()&nbsp;or&nbsp;system&nbsp;initialization:</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">int&nbsp;main(int&nbsp;argc,&nbsp;char**&nbsp;argv)</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">{</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Initialize&nbsp;global&nbsp;PTE&nbsp;subsystem</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;int&nbsp;cpuCount&nbsp;=&nbsp;4;&nbsp;&nbsp;//&nbsp;Your&nbsp;CPU&nbsp;count</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;initializeGlobalPTE(cpuCount);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;...&nbsp;rest&nbsp;of&nbsp;initialization&nbsp;...</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;At&nbsp;shutdown:</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;shutdownGlobalPTE();</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">}</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">---</p>
<p class="p_Normal">&nbsp;</p>
<h2 class="p_Heading2" style="page-break-after: avoid;"><span class="f_Heading2">## SMP Coherence Guarantees</span></h2>
<p class="p_Normal">&nbsp;</p>
<h3 class="p_Heading3" style="page-break-after: avoid;"><span class="f_Heading3"> 1. ASN Epoch Coherence</span></h3>
<p class="p_Normal">- All CPUs see same ASN generation via atomic shared table</p>
<p class="p_Normal">- When ASN generation increments, all CPUs' cached entries become stale</p>
<p class="p_Normal">- Refill on TLB miss automatically uses new generation</p>
<p class="p_Normal">&nbsp;</p>
<h3 class="p_Heading3" style="page-break-after: avoid;"><span class="f_Heading3"> 2. TLB Shootdown</span></h3>
<p class="p_Normal">- `invalidatePTE_AllCPUs()` ensures all CPUs flush the entry</p>
<p class="p_Normal">- Required when modifying page tables</p>
<p class="p_Normal">- Uses atomic operations for coordination</p>
<p class="p_Normal">&nbsp;</p>
<h3 class="p_Heading3" style="page-break-after: avoid;"><span class="f_Heading3"> 3. Per-CPU SPAM Independence</span></h3>
<p class="p_Normal">- Each CPU has its own SPAM cache (no contention on fast path)</p>
<p class="p_Normal">- CPUs don't interfere with each other on TLB lookups</p>
<p class="p_Normal">- Only coordination points are ASN epochs and explicit shootdowns</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">---</p>
<p class="p_Normal">&nbsp;</p>
<h2 class="p_Heading2" style="page-break-after: avoid;"><span class="f_Heading2">## Performance Characteristics</span></h2>
<h3 class="p_Heading3" style="page-break-after: avoid;"><span class="f_Heading3">&nbsp;</span></h3>
<h3 class="p_Heading3" style="page-break-after: avoid;"><span class="f_Heading3"> Fast Path (TLB Hit - Per-CPU)</span></h3>
<p class="p_Normal">- **No contention** - each CPU uses its own SPAM</p>
<p class="p_Normal">- **Lock-free reads** - seqlock protocol in SPAMBucket</p>
<p class="p_Normal">- **~5-10 cycles** - typical TLB hit latency</p>
<p class="p_Normal">&nbsp;</p>
<h3 class="p_Heading3" style="page-break-after: avoid;"><span class="f_Heading3"> Slow Path (TLB Miss)</span></h3>
<p class="p_Normal">- **Page table walk** - ~100-200 cycles</p>
<p class="p_Normal">- **SPAM insertion** - ~10-20 cycles</p>
<p class="p_Normal">- **ASN epoch check** - atomic load (~5 cycles)</p>
<p class="p_Normal">&nbsp;</p>
<h3 class="p_Heading3" style="page-break-after: avoid;"><span class="f_Heading3"> TLB Shootdown (Cross-CPU)</span></h3>
<p class="p_Normal">- **VERY EXPENSIVE** - requires touching all CPUs</p>
<p class="p_Normal">- **~1000+ cycles** - due to inter-processor communication</p>
<p class="p_Normal">- **Minimize usage** - batch invalidations when possible</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">---</p>
<p class="p_Normal">&nbsp;</p>
<h2 class="p_Heading2" style="page-break-after: avoid;"><span class="f_Heading2">## Debugging Aids</span></h2>
<p class="p_Normal">&nbsp;</p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">//&nbsp;Check&nbsp;if&nbsp;entry&nbsp;is&nbsp;still&nbsp;valid&nbsp;(ASN&nbsp;epoch&nbsp;matches)</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">bool&nbsp;isEntryFresh(const&nbsp;SPAMEntry&lt;Ev6PTETraits&gt;*&nbsp;entry,&nbsp;ASNType&nbsp;asn)&nbsp;noexcept</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">{</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!entry&nbsp;||&nbsp;!entry-&gt;isValid())&nbsp;return&nbsp;false;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(entry-&gt;flags.global)&nbsp;return&nbsp;true;&nbsp;&nbsp;//&nbsp;Global&nbsp;entries&nbsp;always&nbsp;valid</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;quint32&nbsp;currentGen&nbsp;=&nbsp;GlobalPTESMP::getASNGeneration(asn);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(entry-&gt;asn&nbsp;==&nbsp;asn&nbsp;&amp;&amp;&nbsp;entry-&gt;asnGenAtFill&nbsp;==&nbsp;currentGen);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">}</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">//&nbsp;Dump&nbsp;SPAM&nbsp;statistics&nbsp;(for&nbsp;debugging)</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">void&nbsp;dumpSPAMStats(CPUIdType&nbsp;cpuId)&nbsp;noexcept</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">{</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;auto&amp;&nbsp;spam&nbsp;=&nbsp;globalSPAM(cpuId);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Add&nbsp;stats&nbsp;methods&nbsp;to&nbsp;Ev6SPAMShardManager</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;qDebug()&nbsp;&lt;&lt;&nbsp;&quot;CPU&quot;&nbsp;&lt;&lt;&nbsp;cpuId&nbsp;&lt;&lt;&nbsp;&quot;SPAM&nbsp;stats:&quot;;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;qDebug()&nbsp;&lt;&lt;&nbsp;&quot;&nbsp;&nbsp;Hits:&quot;&nbsp;&lt;&lt;&nbsp;spam.getHitCount();</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;qDebug()&nbsp;&lt;&lt;&nbsp;&quot;&nbsp;&nbsp;Misses:&quot;&nbsp;&lt;&lt;&nbsp;spam.getMissCount();</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;qDebug()&nbsp;&lt;&lt;&nbsp;&quot;&nbsp;&nbsp;Evictions:&quot;&nbsp;&lt;&lt;&nbsp;spam.getEvictionCount();</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">}</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">---</p>
<h2 class="p_Heading2" style="page-break-after: avoid;"><span class="f_Heading2">&nbsp;</span></h2>
<h2 class="p_Heading2" style="page-break-after: avoid;"><span class="f_Heading2">## Summary</span></h2>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">✅ **Per-CPU SPAM** - Each CPU has independent TLB cache</p>
<p class="p_Normal">✅ **Shared ASN Epochs** - All CPUs coordinate on ASN generations</p>
<p class="p_Normal">✅ **SMP Coherence** - TLB shootdown for page table modifications</p>
<p class="p_Normal">✅ **Naming Convention** - Follows your `global_xxx(cpuId)` pattern</p>
<p class="p_Normal">✅ **Lock-Free Fast Path** - No contention on TLB lookups</p>
<p class="p_Normal">✅ **Atomic Coordination** - Safe for SMP without locks</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">**Ready to integrate!**</p>
<p class="p_Normal">&nbsp;</p>
<p><span style="font-size: 13px; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>

<!--ZOOMSTOP-->
</div></div>
<script type="text/javascript">



function normHeaders() {
 var topicHeadHeight =  $("#idheaderbg > table").first().height() + 1,
	 $topicHeaderBox = $("#idheader"),
	 $topicContentBox = $("#idcontent"),
	 $navHeader = $("#navbar", parent.document),			 
	$navBox = $("div#hmnavframe", parent.document),
	 navHeaderHeight = $navHeader.height();
 if (topicHeadHeight != navHeaderHeight) {
	 $navHeader.css("height",topicHeadHeight + "px");
	 $navBox.css("top", topicHeadHeight + "px");
	 $topicHeaderBox.css("height", topicHeadHeight + "px");
		if ($topicHeaderBox.css("position") == "fixed"){
			$topicContentBox.css("margin-top", topicHeadHeight + "px");
			}
		}
    }
			 
  $(document).ready(function(){
    $(window).on('resize', function() {
      var y = $('#idheader').height(); 
      $('#idcontent').css('margin-top', y);
      var par = window.parent;
      if ($( par ).width() <= $( window ).width()+20) {
        $('#idheader').css('position', 'relative');
        $('#idcontent').css('margin-top', 0);
        $('#idbacktotop').css('display', 'block');
        $('.hmanchor').css('margin-top', -20);
	$('.hmanchor').css('padding-top', 20);
      }
      else {
        $('#idheader').css('position', 'fixed');
        $('#idcontent').css('margin-top', $('#idheader').height());
        $('#idbacktotop').css('display', 'none');
        $('.hmanchor').css('margin-top', -y-20);
		$('.hmanchor').css('padding-top', y+20);
		$("div#hmsplitter", parent.document).css('width', '3px');
      }
	normHeaders();
    });
    
	 $(window).resize(); //trigger event for initially small displays
  });
 

if ((!parent.hmNavigationFrame) && (parent.location) && (parent.location.href)) { $('.sync-toc').show();$('p.crumbs').hide();}

</script>
</body>
</html>
