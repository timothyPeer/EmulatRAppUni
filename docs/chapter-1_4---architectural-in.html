<!DOCTYPE html>
<html>
<head>
   <title>Introduction &gt; Architecture Overview &gt; Chapter 1 - System Overview &gt; 1.4 Major Architectural Layers</title>
   <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />   
   <meta http-equiv="X-UA-Compatible" content="IE=edge" />
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="AlphaCPU,AlphaPipeline,Barriers,Boxes,CBox,Coherency,Control,Controllers,CPUId,Devices,DMA,Domains,DTB,EBox,Execution,ExecutionCoordinator,FaultDispatcher,FBox,Grains,GuestMemory,IBox,IDeviceEmulator,IPIs,IPRs,ITB,Layers,MBox,Memory,MMIO,mmio_DMACoherencyManager,mmio_Manager,PAL,PalBox,PCI,PipelineSlot,Privilege,PTE,Reservations,SafeMemory,SCSI,SMP,SMPManager,SPAM,Storage,TLB,Translation" />
   <meta name="description" content="EMulatR is structured into six conceptual layers. Each layer has a clearly defined responsibility and communicates with adjacent layers through explicit interfaces. No layer..." />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <link type="text/css" href="custom.css" rel="stylesheet" />

   <style TYPE="text/css" media="screen"> 
      html, body { margin:0; 
        padding:0; 
        background: #ffffff; 
      } 
      div#printheader { display: none; }
      #idheader { 
        width:100%; 
        min-height: 60px; 
        padding: 0; 
        margin: 0;
        position: fixed;
        top: 0;
        background: #F0F0F0;
        z-index: 2;
      } 
      /* The "min-height" for "#idheader table" ensures that the (blue) header of the topic
         has at least the same height as the header of the navigation panel left of it */
      #idheader table { min-height: 59px;}             
      #idheader h1 span { color: #000000 }     
      #idnav {
        text-align: right;
        width: 126px;
        vertical-align: middle;        
      } 
      #idnav a { text-decoration: none }
      #idnav span {
        display: inline-block;
        width: 24px;
        height: 24px;
        margin-left: 4px;
        background:url('hm_webhelp_buttons_white.png') top left no-repeat;
      } 
      #idnav a span {
        background-image:url('hm_webhelp_buttons_grey.png');
      } 
      #idnav a span:hover {
        background-image:url('hm_webhelp_buttons_yellow.png');
      } 
      #idnav span.hmbtnprev { background-position: 0 -32px }
      #idnav span.hmbtnnext { background-position: -24px -32px }
      #idnav span.hmbtntop  { background-position: -48px -32px }
      #idnav span.hmbtntoggle  { width: 20px; background-position: -70px -32px }
      #idnav span.hmbtnprint  { background-position: -88px -32px }

      #callout-table, #overview-table {display:block; position:relative; top:0; left:0;}
      #callout-icon {display:block; position:absolute; top:-11px; left:-11px;}
      #callout-icon-flag {display:block; position:absolute; top:-11px; left:-8px;}
      #callout-table a {text-decoration: none; color: blue;}
      #callout-table a:visited {text-decoration: none; color: blue;}
      #overview-table a {text-decoration: none; color: black;}
      #overview-table a:visited {text-decoration: none; color: black;}
      #callout-table a:hover, #overview-table a:hover {text-decoration: underline;}       
      p.help-url { margin: 20px 0 5px 0; text-align: center; }
	  p.help-url a:link { font-size: 50%; text-decoration: none; color: black; }
	  p.help-url a:visited { color: black; }
	  p.help-url a:hover { font-size: 95%; text-decoration: underline; }
      #switchtoggles { text-align: right; padding: 0 2px 0 0; font-size: 90%; } 
      .sync-toc { color: #000000; font-size: 8pt; font-weight: bold; display: none; }
      .sync-toc a { color: #000000; text-decoration: none; font-weight: bold;}
      .sync-toc a:visited { color: #000000; }
      .sync-toc a:hover { text-decoration: underline; }
	  a#printbuttonlink { cursor: pointer; }
      a.hmanchor { display: inline-block; margin-top: -4em; padding-top: 4em; }  
   </style>
   <style TYPE="text/css" media="print">
      div#idheader, img.dropdown-toggle-icon, p.help-url { display:none } 
   </style>
   
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "chapter-1_4---architectural-in.html");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body>


<div id="printheader"><h1 class="p_Heading1" style="page-break-after: avoid;"><span class="f_Heading1">1.4 Major Architectural Layers</span></h1>
</div>
<div id="idheader">
<div id="idheaderbg">
<table style="width:100%;border:none;margin:0px;" cellspacing="0" cellpadding="0"> 
  <tr>
    <td class="topichead" style="text-align:left; vertical-align:middle">
      <p class="sync-toc">&lt;&lt; <a rel="nofollow" href="index.html?chapter-1_4---architectural-in.html" target="_top">Click to Display Table of Contents</a> &gt;&gt;</p>
      <p class="crumbs"><b>Navigation:</b>&nbsp;
      
      <a href="introduction.html">Introduction</a> &gt; <a href="architecture-overview.html">Architecture Overview</a> &gt; <a href="chapter-1_.html">Chapter 1 - System Overview</a>&nbsp;&gt;</p>
   
      <h1 class="p_Heading1" style="page-break-after: avoid;"><span class="f_Heading1">1.4 Major Architectural Layers</span></h1>

    </td>
    <td class="topichead" id="idnav">
      
      <a href="chapter-1_3---major-architectu.html" title="Previous Topic"><span class="hmbtnprev"></span></a>
      <a href="chapter-1_.html" title="Parent Chapter"><span class="hmbtntop"></span></a>
      <a href="1_5-non-goalschapter1.html" title="Next Topic"><span class="hmbtnnext"></span></a>
      
    </td>
  </tr>  
</table>
</div>
</div>  

<div id="idcontent"><div id="innerdiv">
<!-- Ask Internet Explorer 6.users to update their obsolete and dangerous browser --> 
<!--[if lt IE 7]><div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;'><a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode"><img src="http://storage.ie6countdown.com/assets/100/images/banners/warning_bar_0000_us.jpg" border="0" height="42" width="820" alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today." /></a></div><![endif]-->

<!--ZOOMRESTART-->
<p class="p_Normal">EMulatR is structured into six conceptual layers. Each layer has a clearly defined responsibility and communicates with adjacent layers through explicit interfaces. No layer bypasses another's authority.</p>
<p class="p_Normal">&nbsp;</p>
<h2 class="p_Heading2" style="page-break-after: avoid;"><span class="f_Heading2">1.4.1 Execution Layer</span></h2>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">The execution layer owns the per-CPU run loop and instruction lifecycle. It consists of AlphaCPU (the unit of execution), AlphaPipeline (the six-stage pipeline), PipelineSlot (per-stage instruction state), and instruction grains (the decoded instruction abstraction). Each AlphaCPU instance represents one physical Alpha processor with its own independent run loop, register files, and pipeline state.</p>
<p class="p_Normal">&nbsp;</p>
<h2 class="p_Heading2" style="page-break-after: avoid;"><span class="f_Heading2">1.4.2 Execution Domains (Boxes)</span></h2>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Execution is partitioned into six functional domains called Boxes. Each Box groups related architectural behavior and is invoked by grains during the Execute (EX) stage. Boxes are capability boundaries, not control boundaries — they do not own time, do not schedule instructions, and do not advance the pipeline.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal" style="text-indent: 0; padding-left: 13px; margin-left: 0;"><span class="f_Normal" style="font-family: Arial,'Lucida Sans Unicode','Lucida Grande','Lucida Sans';display:inline-block;width:13px;margin-left:-13px">&#8226;</span>IBox – Instruction frontend (fetch, decode, grain resolution)</p>
<p class="p_Normal" style="text-indent: 0; padding-left: 13px; margin-left: 0;"><span class="f_Normal" style="font-family: Arial,'Lucida Sans Unicode','Lucida Grande','Lucida Sans';display:inline-block;width:13px;margin-left:-13px">&#8226;</span>EBox – Integer and address execution (ALU, conditional moves)</p>
<p class="p_Normal" style="text-indent: 0; padding-left: 13px; margin-left: 0;"><span class="f_Normal" style="font-family: Arial,'Lucida Sans Unicode','Lucida Grande','Lucida Sans';display:inline-block;width:13px;margin-left:-13px">&#8226;</span>FBox – Floating-point execution (IEEE 754, VAX compatibility)</p>
<p class="p_Normal" style="text-indent: 0; padding-left: 13px; margin-left: 0;"><span class="f_Normal" style="font-family: Arial,'Lucida Sans Unicode','Lucida Grande','Lucida Sans';display:inline-block;width:13px;margin-left:-13px">&#8226;</span>MBox – Memory operations (load/store, DTB translation)</p>
<p class="p_Normal" style="text-indent: 0; padding-left: 13px; margin-left: 0;"><span class="f_Normal" style="font-family: Arial,'Lucida Sans Unicode','Lucida Grande','Lucida Sans';display:inline-block;width:13px;margin-left:-13px">&#8226;</span>CBox – Coherency and serialization (barriers, write buffer, LL/SC)</p>
<p class="p_Normal" style="text-indent: 0; padding-left: 13px; margin-left: 0;"><span class="f_Normal" style="font-family: Arial,'Lucida Sans Unicode','Lucida Grande','Lucida Sans';display:inline-block;width:13px;margin-left:-13px">&#8226;</span>PalBox – Privileged execution (CALL_PAL, MFPR/MTPR, mode transitions)</p>
<p class="p_Normal">&nbsp;</p>
<h2 class="p_Heading2" style="page-break-after: avoid;"><span class="f_Heading2">1.4.3 Memory and Coherency Layer</span></h2>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">The memory layer models Alpha's weakly ordered memory architecture. GuestMemory represents the shared physical address space and is the sole authority for physical memory visibility, LL/SC reservation invalidation, and SMP coherency effects. SafeMemory provides the backing store with bounds checking. The PTE/TLB subsystem handles virtual-to-physical translation with per-CPU ITB and DTB instances using SPAM (Set-Partitioned Address Mapping) structures.</p>
<p class="p_Normal">&nbsp;</p>
<h2 class="p_Heading2" style="page-break-after: avoid;"><span class="f_Heading2">1.4.4 Privilege and Control Layer</span></h2>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">The privilege layer enforces Alpha's hardware-defined privileged execution environment. PAL (Privileged Architecture Library) is the sole authority for exception dispatch, interrupt dispatch, privileged register access (IPRs), context switching, and low-level SMP coordination. The FaultDispatcher queues and prioritizes all exceptional conditions. IPR storage provides dedicated registers for processor control state.</p>
<p class="p_Normal">&nbsp;</p>
<h2 class="p_Heading2" style="page-break-after: avoid;"><span class="f_Heading2">1.4.5 SMP Coordination Layer</span></h2>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">The SMP layer manages multi-processor coordination. CPUs are created and identified by the SMP Manager within the ExecutionCoordinator. Each CPU has a unique CPUId with independent pipeline, registers, TLBs, write buffers, and LL/SC reservation state. Cross-CPU coordination occurs exclusively through GuestMemory (visibility and LL/SC invalidation), barriers (ordering enforcement), and IPIs (explicit signaling including TLB shootdown).</p>
<p class="p_Normal">&nbsp;</p>
<h2 class="p_Heading2" style="page-break-after: avoid;"><span class="f_Heading2">1.4.6 Device and MMIO Layer</span></h2>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">The device layer models external hardware agents that participate in the memory system. Devices are memory-mapped, asynchronous, interrupt-driven, and strongly ordered at the MMIO boundary. The mmio_Manager routes accesses to registered IDeviceEmulator instances. DMA transfers are coordinated by the mmio_DMACoherencyManager. The controller stack implements a PCI bus model with SCSI host adapters and virtual storage devices.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_SeeAlso" style="page-break-after: avoid;"><span class="f_SeeAlso">See Also: <a href="chapter-4---functionexecution-.html" class="topiclink">Chapter 4 - Functional Execution Domains (&quot;Boxes)</a>; <a href="chapter-5---memory-system-arch.html" class="topiclink">Chapter 5 - Memory System Architecture</a>; <a href="chapter-8---pal-and-privleged-.html" class="topiclink">Chapter 8 - PAL and Privileged Boundary</a>; <a href="chapter9-smparchitecture.html" class="topiclink">Chapter 9 - SMP Architecture</a>; <a href="chapter-10---devices-and-mmio.html" class="topiclink">Chapter 10 – Devices and Memory-Mapped I/O (MMIO)</a>.</span></p>

<!--ZOOMSTOP-->
</div></div>
<script type="text/javascript">



function normHeaders() {
 var topicHeadHeight =  $("#idheaderbg > table").first().height() + 1,
	 $topicHeaderBox = $("#idheader"),
	 $topicContentBox = $("#idcontent"),
	 $navHeader = $("#navbar", parent.document),			 
	$navBox = $("div#hmnavframe", parent.document),
	 navHeaderHeight = $navHeader.height();
 if (topicHeadHeight != navHeaderHeight) {
	 $navHeader.css("height",topicHeadHeight + "px");
	 $navBox.css("top", topicHeadHeight + "px");
	 $topicHeaderBox.css("height", topicHeadHeight + "px");
		if ($topicHeaderBox.css("position") == "fixed"){
			$topicContentBox.css("margin-top", topicHeadHeight + "px");
			}
		}
    }
			 
  $(document).ready(function(){
    $(window).on('resize', function() {
      var y = $('#idheader').height(); 
      $('#idcontent').css('margin-top', y);
      var par = window.parent;
      if ($( par ).width() <= $( window ).width()+20) {
        $('#idheader').css('position', 'relative');
        $('#idcontent').css('margin-top', 0);
        $('#idbacktotop').css('display', 'block');
        $('.hmanchor').css('margin-top', -20);
	$('.hmanchor').css('padding-top', 20);
      }
      else {
        $('#idheader').css('position', 'fixed');
        $('#idcontent').css('margin-top', $('#idheader').height());
        $('#idbacktotop').css('display', 'none');
        $('.hmanchor').css('margin-top', -y-20);
		$('.hmanchor').css('padding-top', y+20);
		$("div#hmsplitter", parent.document).css('width', '3px');
      }
	normHeaders();
    });
    
	 $(window).resize(); //trigger event for initially small displays
  });
 

if ((!parent.hmNavigationFrame) && (parent.location) && (parent.location.href)) { $('.sync-toc').show();$('p.crumbs').hide();}

</script>
</body>
</html>
