<!DOCTYPE html>
<html>
<head>
   <title>ASA-EMulatR Reference Guide &gt; Introduction &gt; Architecture Overview &gt; Chapter 22 – Testing, Validation, and Architectural Compliance &gt; 22.5 Memory Ordering and LL/SC Validation</title>
   <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />   
   <meta http-equiv="X-UA-Compatible" content="IE=edge" />
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta name="description" content="22.5.1 Memory Ordering Validation &nbsp;Memory model validation focuses on: visibility ordering (stores become visible to other CPUs in the correct order after barriers), store..." />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <link type="text/css" href="custom.css" rel="stylesheet" />

   <style TYPE="text/css" media="screen"> 
      html, body { margin:0; 
        padding:0; 
        background: #ffffff; 
      } 
      div#printheader { display: none; }
      #idheader { 
        width:100%; 
        min-height: 60px; 
        padding: 0; 
        margin: 0;
        position: fixed;
        top: 0;
        background: #2C5D88;
        z-index: 2;
      } 
      /* The "min-height" for "#idheader table" ensures that the (blue) header of the topic
         has at least the same height as the header of the navigation panel left of it */
      #idheader table { min-height: 59px;}             
      #idheader h1 span { color: #FFF }     
      #idnav {
        text-align: right;
        width: 158px;
        vertical-align: middle;        
      } 
      #idnav a { text-decoration: none }
      #idnav span {
        display: inline-block;
        width: 24px;
        height: 24px;
        margin-left: 4px;
        background:url('hm_webhelp_buttons_grey.png') top left no-repeat;
      } 
      #idnav a span {
        background-image:url('hm_webhelp_buttons_white.png');
      } 
      #idnav a span:hover {
        background-image:url('hm_webhelp_buttons_orange.png');
      } 
      #idnav span.hmbtnprev { background-position: 0 -32px }
      #idnav span.hmbtnnext { background-position: -24px -32px }
      #idnav span.hmbtntop  { background-position: -48px -32px }
      #idnav span.hmbtntoggle  { width: 20px; background-position: -70px -32px }
      #idnav span.hmbtnprint  { background-position: -88px -32px }

      #callout-table, #overview-table {display:block; position:relative; top:0; left:0;}
      #callout-icon {display:block; position:absolute; top:-11px; left:-11px;}
      #callout-icon-flag {display:block; position:absolute; top:-11px; left:-8px;}
      #callout-table a {text-decoration: none; color: blue;}
      #callout-table a:visited {text-decoration: none; color: blue;}
      #overview-table a {text-decoration: none; color: black;}
      #overview-table a:visited {text-decoration: none; color: black;}
      #callout-table a:hover, #overview-table a:hover {text-decoration: underline;}       
      p.help-url { margin: 20px 0 5px 0; text-align: center; }
	  p.help-url a:link { font-size: 50%; text-decoration: none; color: black; }
	  p.help-url a:visited { color: black; }
	  p.help-url a:hover { font-size: 95%; text-decoration: underline; }
      #switchtoggles { text-align: right; padding: 0 2px 0 0; font-size: 90%; } 
      .sync-toc { color: #FFF; font-size: 8pt; font-weight: bold; display: none; }
      .sync-toc a { color: #FFF; text-decoration: none; font-weight: bold;}
      .sync-toc a:visited { color: #FFF; }
      .sync-toc a:hover { text-decoration: underline; }
	  a#printbuttonlink { cursor: pointer; }
      a.hmanchor { display: inline-block; margin-top: -4em; padding-top: 4em; }  
   </style>
   <style TYPE="text/css" media="print">
      div#idheader, img.dropdown-toggle-icon, p.help-url { display:none } 
   </style>
   
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "22_5-memory-ordering-and-ll_sc.html");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body>


<div id="printheader"><h1 class="p_Heading1" style="page-break-after: avoid;"><span class="f_Heading1">22.5 Memory Ordering and LL/SC Validation</span></h1>
</div>
<div id="idheader">
<div id="idheaderbg">
<table style="width:100%;border:none;margin:0px;" cellspacing="0" cellpadding="0"> 
  <tr>
    <td class="topichead" style="text-align:left; vertical-align:middle">
      <p class="sync-toc">&lt;&lt; <a rel="nofollow" href="index.html?22_5-memory-ordering-and-ll_sc.html" target="_top">Click to Display Table of Contents</a> &gt;&gt;</p>
      <p class="crumbs"><b>Navigation:</b>&nbsp;
      
      <a href="license-_-attributions.html">ASA-EMulatR Reference Guide</a> &gt; <a href="introduction.html">Introduction</a> &gt; <a href="architecture-overview.html">Architecture Overview</a> &gt; <a href="chapter-22---testing_-validati.html">Chapter 22 – Testing, Validation, and Architectural Compliance</a>&nbsp;&gt;</p>
   
      <h1 class="p_Heading1" style="page-break-after: avoid;"><span class="f_Heading1">22.5 Memory Ordering and LL/SC Validation</span></h1>

    </td>
    <td class="topichead" id="idnav">
      
      <a href="22_4-exception-and-fault-valid.html" title="Previous Topic"><span class="hmbtnprev"></span></a>
      <a href="chapter-22---testing_-validati.html" title="Parent Chapter"><span class="hmbtntop"></span></a>
      <a href="22_6-pal-and-privilege-boundar.html" title="Next Topic"><span class="hmbtnnext"></span></a>
      <a id="printbuttonlink" onclick=";$('div#idcontent').css('margin-top', '1em');printTopic();$('#idcontent').css('margin-top', $('#idheader').height());" title="Print"><span class="hmbtnprint"></span></a>
    </td>
  </tr>  
</table>
</div>
</div>  

<div id="idcontent"><div id="innerdiv">
<!-- Ask Internet Explorer 6.users to update their obsolete and dangerous browser --> 
<!--[if lt IE 7]><div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;'><a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode"><img src="http://storage.ie6countdown.com/assets/100/images/banners/warning_bar_0000_us.jpg" border="0" height="42" width="820" alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today." /></a></div><![endif]-->

<!--ZOOMRESTART-->
<h2 class="p_Heading2" style="page-break-after: avoid;"><span class="f_Heading2">22.5.1 Memory Ordering Validation</span></h2>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Memory model validation focuses on: visibility ordering (stores become visible to other CPUs in the correct order after barriers), store buffering behavior (write buffer drains at correct serialization points), barrier enforcement (MB produces global visibility, WMB produces local write ordering, EXCB resolves pending exceptions before continuation), and cross-CPU ordering (stores committed by CPU A are visible to CPU B after the appropriate barrier sequence completes).</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Tests include: store-load reordering scenarios (verify that loads after MB see stores from before MB on another CPU), barrier release edge cases (verify that barriers release only when all conditions are met), DMA vs CPU ordering (verify that DMA completions are visible after the device signals completion), and false sharing scenarios (verify that stores to adjacent-but-distinct cache lines do not interfere with reservations on non-overlapping addresses).</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Failures in memory ordering validation are considered critical correctness violations — they indicate that the memory model contract is broken, which invalidates all higher-level assumptions about SMP correctness.</p>
<p class="p_Normal">&nbsp;</p>
<hr style="height:1px; color:#000000; border-width:0; background-color:#000000;" /><p class="p_Normal">&nbsp;</p>
<h2 class="p_Heading2" style="page-break-after: avoid;"><span class="f_Heading2">22.5.2 LL/SC Validation</span></h2>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">LL/SC validation verifies: reservation granularity (cache-line level, 64 bytes on EV6), reservation invalidation rules (any store to the same cache line from any CPU breaks the reservation), failure semantics (STx_C returns 0 in Ra and does not write memory), and SMP contention behavior (multiple CPUs contending on the same cache line produce correct forward progress guarantees).</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Specific tests: multiple CPUs performing concurrent LL/SC to the same cache line (exactly one succeeds per round), false sharing on adjacent addresses within the same cache line (reservation broken even though different bytes are targeted), exception-induced reservation clearing (LL followed by fault → STx_C must fail), barrier-induced clearing (LL followed by MB → STx_C must fail), and PAL boundary clearing (LL followed by CALL_PAL → STx_C must fail).</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">LL/SC correctness is mandatory for OS-level correctness — operating systems rely on atomic sequences for lock acquisition, reference counting, and concurrent data structure manipulation.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_SeeAlso" style="page-break-after: avoid;"><span class="f_SeeAlso">See Also: <a href="chapter-5_11-load-locked-_-sto.html" class="topiclink">5.11 Load-Locked / Store-Conditional (LL/SC)</a> ; <a href="chapter-6---serialization-and-.html" class="topiclink">Chapter 6 - Serialization and Stall Model</a> &nbsp;(barrier validation targets).</span></p>

<!--ZOOMSTOP-->
</div></div>
<script type="text/javascript">

  function printTopic() {
    if (document.queryCommandSupported('print')) { document.execCommand('print', false, null); }
    else { window.print(); }
  }



function normHeaders() {
 var topicHeadHeight =  $("#idheaderbg > table").first().height() + 1,
	 $topicHeaderBox = $("#idheader"),
	 $topicContentBox = $("#idcontent"),
	 $navHeader = $("#navbar", parent.document),			 
	$navBox = $("div#hmnavframe", parent.document),
	 navHeaderHeight = $navHeader.height();
 if (topicHeadHeight != navHeaderHeight) {
	 $navHeader.css("height",topicHeadHeight + "px");
	 $navBox.css("top", topicHeadHeight + "px");
	 $topicHeaderBox.css("height", topicHeadHeight + "px");
		if ($topicHeaderBox.css("position") == "fixed"){
			$topicContentBox.css("margin-top", topicHeadHeight + "px");
			}
		}
    }
			 
  $(document).ready(function(){
    $(window).on('resize', function() {
      var y = $('#idheader').height(); 
      $('#idcontent').css('margin-top', y);
      var par = window.parent;
      if ($( par ).width() <= $( window ).width()+20) {
        $('#idheader').css('position', 'relative');
        $('#idcontent').css('margin-top', 0);
        $('#idbacktotop').css('display', 'block');
        $('.hmanchor').css('margin-top', -20);
	$('.hmanchor').css('padding-top', 20);
      }
      else {
        $('#idheader').css('position', 'fixed');
        $('#idcontent').css('margin-top', $('#idheader').height());
        $('#idbacktotop').css('display', 'none');
        $('.hmanchor').css('margin-top', -y-20);
		$('.hmanchor').css('padding-top', y+20);
		$("div#hmsplitter", parent.document).css('width', '3px');
      }
	normHeaders();
    });
    
    //Hide Print button on touch devices
    if (hmBrowser.nonDeskTouch) {
      $("a#printbuttonlink").hide();
      $("#idnav").css({"width": "125px", "padding-left": "0", "padding-right": "2px"});
    }
	 $(window).resize(); //trigger event for initially small displays
  });
 

if ((!parent.hmNavigationFrame) && (parent.location) && (parent.location.href)) { $('.sync-toc').show();$('p.crumbs').hide();}
var baseurl = document.URL.substring(0,document.URL.lastIndexOf("/")+1); 
$('#idcontent').append('<p class="help-url"><b>URL of this topic:<br /></b><a href="'+baseurl+'index.html' +
'?22_5-memory-ordering-and-ll_sc.html" target="_top">'+baseurl+'index.html?22_5-memory-ordering-and-ll_sc.html</a></p>');

</script>
</body>
</html>
