hmLoadTopic({
hmKeywords:"",
hmTitle:"MBox",
hmDescription:"Below is a **clean, grain-scoped specification** for **MBox responsibilities**, deliberately restricted to **what instruction grains executed in the MBox must support** — not...",
hmPrevLink:"",
hmNextLink:"",
hmParentLink:"appendix---trait-examples.html",
hmBreadCrumbs:"",
hmTitlePath:"ASA-EMulatR Reference Guide > Introduction > Appendix > Appendix I – Glossary and Acronyms",
hmHeader:"<h1 class=\"p_Heading1\" style=\"page-break-after: avoid;\"><span class=\"f_Heading1\">MBox<\/span><\/h1>\n\r",
hmBody:"<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Below is a **clean, grain-scoped specification** for **MBox responsibilities**, deliberately restricted to **what instruction grains executed in the MBox must support** — not pipeline orchestration, not global policy, not device behavior.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">This is written as a **design contract** you can keep next to the MBox executor header.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">---<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"># MBox Grain Support Specification<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">(Alpha AXP – EV6-style model)<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">## 1. Scope and Intent<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">The **MBox** is responsible for executing **memory-affecting and ordering-affecting instruction grains** whose architectural effects include:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">* Data memory access<\/p>\n\r<p class=\"p_Normal\">* Atomicity \/ reservation semantics<\/p>\n\r<p class=\"p_Normal\">* Memory ordering guarantees<\/p>\n\r<p class=\"p_Normal\">* Cache \/ prefetch \/ hint semantics<\/p>\n\r<p class=\"p_Normal\">* Certain PAL-mediated memory operations<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">This specification defines **only what an individual MBox grain must implement** to be architecturally correct.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">The MBox **does not**:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">* Own register writeback<\/p>\n\r<p class=\"p_Normal\">* Resolve PAL vectors<\/p>\n\r<p class=\"p_Normal\">* Perform instruction fetch or decode<\/p>\n\r<p class=\"p_Normal\">* Implement scheduling or hazard detection<\/p>\n\r<p class=\"p_Normal\">* Implement device behavior<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">---<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">## 2. Instruction Classes Assigned to MBox<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">An instruction grain is executed in the MBox **iff** it has at least one of the following semantics:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">* `S_MemFmt`<\/p>\n\r<p class=\"p_Normal\">* `S_Load` or `S_Store`<\/p>\n\r<p class=\"p_Normal\">* `S_LoadLocked` or `S_StoreConditional`<\/p>\n\r<p class=\"p_Normal\">* `S_Barrier`<\/p>\n\r<p class=\"p_Normal\">* Explicit cache \/ prefetch \/ write-hint semantics<\/p>\n\r<p class=\"p_Normal\">* PAL instructions whose architectural effect is memory-side<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"> 2.1 Memory-Format Instructions<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Examples:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">* `LDQ`, `LDQ_U`, `LDT`, `LDS`, `LDG`, `LDF`<\/p>\n\r<p class=\"p_Normal\">* `STQ`, `STQ_U`, `STT`, `STS`, `STG`, `STF`<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"> 2.2 Atomic \/ Reservation Instructions<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Examples:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">* `LDL_L`, `LDQ_L`<\/p>\n\r<p class=\"p_Normal\">* `STL_C`, `STQ_C`<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"> 2.3 Memory Ordering \/ Barriers<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Examples:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">* `MB`, `WMB`, `TRAPB`<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"> 2.4 Cache \/ Hint Instructions<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Examples:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">* `FETCH`, `FETCH_M`<\/p>\n\r<p class=\"p_Normal\">* `WH64`, `WH64EN`<\/p>\n\r<p class=\"p_Normal\">* `ECB`, `EXCB`<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"> 2.5 PALcode Memory Operations<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Examples:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">* `PAL_LDQP`<\/p>\n\r<p class=\"p_Normal\">* `PAL_STQP`<\/p>\n\r<p class=\"p_Normal\">* `PAL_CFLUSH`<\/p>\n\r<p class=\"p_Normal\">* `PAL_DRAINA`<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">---<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">## 3. Mandatory Responsibilities of an MBox Grain<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Each MBox grain **must implement all applicable items below**.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">---<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">## 4. Effective Address Formation<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">**Every MBox grain that accesses memory must:**<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">1. Compute VA as:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"> &nbsp; ```<\/p>\n\r<p class=\"p_Normal\"> &nbsp; VA = Rb + signext(disp16)<\/p>\n\r<p class=\"p_Normal\"> &nbsp; ```<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">2. Apply instruction-specific address modification:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"> &nbsp; * `_U` instructions: clear low bits or compute lane index<\/p>\n\r<p class=\"p_Normal\"> &nbsp; * Alignment-sensitive instructions: validate natural alignment<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">3. Record `faultVA` on success or failure<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">---<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">## 5. Alignment Handling<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Each grain must enforce alignment rules **exactly per instruction**:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">| Instruction &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | Alignment Required &nbsp; &nbsp; |<\/p>\n\r<p class=\"p_Normal\">| --------------------- | ---------------------- |<\/p>\n\r<p class=\"p_Normal\">| LDQ \/ STQ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | 8 bytes &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<\/p>\n\r<p class=\"p_Normal\">| LDT \/ STT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | 8 bytes &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<\/p>\n\r<p class=\"p_Normal\">| LDS \/ LDF \/ STS \/ STF | 4 bytes &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<\/p>\n\r<p class=\"p_Normal\">| LDQ_U \/ STQ_U &nbsp; &nbsp; &nbsp; &nbsp; | **No alignment fault** |<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">If alignment fails:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">* The grain must construct a **PendingEvent** with:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"> &nbsp;* `MemoryFaultType::ALIGNMENT`<\/p>\n\r<p class=\"p_Normal\"> &nbsp;* `faultVA = VA`<\/p>\n\r<p class=\"p_Normal\"> &nbsp;* `isWrite` correctly set<\/p>\n\r<p class=\"p_Normal\">* Execution must stop immediately<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">---<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">## 6. Address Translation and Access Control<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Each MBox grain must:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">1. Perform **DTB lookup** using:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"> &nbsp; * `VA`<\/p>\n\r<p class=\"p_Normal\"> &nbsp; * current `ASN`<\/p>\n\r<p class=\"p_Normal\"> &nbsp; * data realm<\/p>\n\r<p class=\"p_Normal\">2. On failure:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"> &nbsp; * Raise DTB miss PendingEvent<\/p>\n\r<p class=\"p_Normal\">3. Validate access permissions:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"> &nbsp; * Read vs write<\/p>\n\r<p class=\"p_Normal\"> &nbsp; * Kernel vs user<\/p>\n\r<p class=\"p_Normal\">4. On violation:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"> &nbsp; * Raise access-violation PendingEvent<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">The grain **must not**:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">* Modify TLBs<\/p>\n\r<p class=\"p_Normal\">* Perform page table walks directly<\/p>\n\r<p class=\"p_Normal\">* Resolve PAL vectors<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">---<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">## 7. Physical Memory Access<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Each MBox grain must:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">* Translate `VA → PA`<\/p>\n\r<p class=\"p_Normal\">* Perform physical memory access using SafeMemory:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"> &nbsp;* Byte \/ long \/ quad as required<\/p>\n\r<p class=\"p_Normal\">* Detect and propagate:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"> &nbsp;* Bus errors<\/p>\n\r<p class=\"p_Normal\"> &nbsp;* Device faults<\/p>\n\r<p class=\"p_Normal\"> &nbsp;* MMIO exceptions<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">On failure:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">* Raise a memory fault PendingEvent<\/p>\n\r<p class=\"p_Normal\">* Preserve `faultVA`<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">---<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">## 8. Reservation Semantics (LL\/SC)<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">For grains with `S_LoadLocked` or `S_StoreConditional`:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"> Load-Locked (`LD*_L`)<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">* Establish reservation:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"> &nbsp;* `ReservationManager::setReservation(cpuId, PA)`<\/p>\n\r<p class=\"p_Normal\">* Load value normally<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"> Store-Conditional (`ST*_C`)<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">* Verify reservation:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"> &nbsp;* On success:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"> &nbsp; &nbsp;* Perform store<\/p>\n\r<p class=\"p_Normal\"> &nbsp; &nbsp;* Return success (payload = 1)<\/p>\n\r<p class=\"p_Normal\"> &nbsp;* On failure:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"> &nbsp; &nbsp;* Do **not** store<\/p>\n\r<p class=\"p_Normal\"> &nbsp; &nbsp;* Return failure (payload = 0)<\/p>\n\r<p class=\"p_Normal\">* Clear reservation in all cases<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">MBox grains **must** call reservation invalidation on:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">* Any successful store<\/p>\n\r<p class=\"p_Normal\">* Any conflicting store to the same PA<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">---<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">## 9. Payload Production<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Each MBox grain must produce exactly one of:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">* **No payload** (stores, barriers, cache ops)<\/p>\n\r<p class=\"p_Normal\">* **One 64-bit payload** (loads, LL\/SC result)<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Rules:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">* Payload is an **opaque architectural image**<\/p>\n\r<p class=\"p_Normal\">* FP loads place mapped FP bits into payload<\/p>\n\r<p class=\"p_Normal\">* Integer loads place integer bits into payload<\/p>\n\r<p class=\"p_Normal\">* Store-conditional writes success\/failure indicator<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Set:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">```<\/p>\n\r<p class=\"p_Normal\">slot.payload<\/p>\n\r<p class=\"p_Normal\">slot.needsWriteback<\/p>\n\r<p class=\"p_Normal\">```<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">The grain **must not** write registers directly.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">---<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">## 10. Memory Ordering and Barriers<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">For instructions with `S_Barrier`:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">* The grain must:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"> &nbsp;* Enforce ordering with respect to:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"> &nbsp; &nbsp;* Prior loads<\/p>\n\r<p class=\"p_Normal\"> &nbsp; &nbsp;* Prior stores<\/p>\n\r<p class=\"p_Normal\">* Implementation may be:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"> &nbsp;* Logical fence<\/p>\n\r<p class=\"p_Normal\"> &nbsp;* Pipeline serialization<\/p>\n\r<p class=\"p_Normal\"> &nbsp;* Reservation flush<\/p>\n\r<p class=\"p_Normal\">* Exact mechanism is implementation-defined<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">The grain must **not**:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">* Perform any memory access<\/p>\n\r<p class=\"p_Normal\">* Modify registers<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">---<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">## 11. Cache \/ Hint Instructions<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">For cache or hint instructions:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">* Grains must:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"> &nbsp;* Compute VA<\/p>\n\r<p class=\"p_Normal\"> &nbsp;* Perform translation and permission checks if required<\/p>\n\r<p class=\"p_Normal\"> &nbsp;* Notify cache \/ memory subsystem<\/p>\n\r<p class=\"p_Normal\">* Architectural state **must not change**<\/p>\n\r<p class=\"p_Normal\">* No payload is produced<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">---<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">## 12. PAL Memory Grains (MBox side)<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">PAL grains executed in MBox must:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">* Obey all rules above<\/p>\n\r<p class=\"p_Normal\">* Use physical addressing if specified<\/p>\n\r<p class=\"p_Normal\">* Bypass ASN where architecturally required<\/p>\n\r<p class=\"p_Normal\">* Defer PAL vector resolution to the dispatcher<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">---<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">## 13. Forbidden Responsibilities (Explicitly Out of Scope)<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">An MBox grain must **never**:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">* Write integer or FP registers directly<\/p>\n\r<p class=\"p_Normal\">* Update PC<\/p>\n\r<p class=\"p_Normal\">* Modify PS or IPL<\/p>\n\r<p class=\"p_Normal\">* Resolve PAL vectors<\/p>\n\r<p class=\"p_Normal\">* Perform instruction decode<\/p>\n\r<p class=\"p_Normal\">* Access other CPUs’ registers<\/p>\n\r<p class=\"p_Normal\">* Manage pipeline scheduling<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">---<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">## 14. Minimal Required Interfaces<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">An MBox grain assumes availability of:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">* `globalEv6SPAM()` (DTB access)<\/p>\n\r<p class=\"p_Normal\">* `globalFaultDispatcher(cpuId)`<\/p>\n\r<p class=\"p_Normal\">* `SafeMemory` PA read\/write<\/p>\n\r<p class=\"p_Normal\">* `ReservationManager`<\/p>\n\r<p class=\"p_Normal\">* `PipelineSlot` (payload + bookkeeping)<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">---<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">## 15. Summary (One-Page Mental Model)<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">&gt; **An MBox grain is responsible for everything that happens *between* a virtual address and an architectural payload — and nothing beyond that.**<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">It:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">* Computes addresses<\/p>\n\r<p class=\"p_Normal\">* Enforces alignment<\/p>\n\r<p class=\"p_Normal\">* Performs translation<\/p>\n\r<p class=\"p_Normal\">* Applies permissions<\/p>\n\r<p class=\"p_Normal\">* Touches memory<\/p>\n\r<p class=\"p_Normal\">* Manages reservations<\/p>\n\r<p class=\"p_Normal\">* Produces payloads<\/p>\n\r<p class=\"p_Normal\">* Raises faults<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">It does **not**:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">* Write registers<\/p>\n\r<p class=\"p_Normal\">* Interpret results<\/p>\n\r<p class=\"p_Normal\">* Control execution flow<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">---<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">If you want next, I can:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">* Do the same spec for **EBox**, **FBox**, or **IBox**<\/p>\n\r<p class=\"p_Normal\">* Map your existing grains against this checklist<\/p>\n\r<p class=\"p_Normal\">* Turn this into a header-level contract comment<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">MBox owns:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\" style=\"text-indent: 0; padding-left: 0.8125rem; margin-left: 0;\"><span class=\"f_Normal\" style=\"font-family: Arial,\'Lucida Sans Unicode\',\'Lucida Grande\',\'Lucida Sans\';display:inline-block;width:0.8125rem;margin-left:-0.8125rem\">&#8226;<\/span>TLB<\/p>\n\r<p class=\"p_Normal\" style=\"text-indent: 0; padding-left: 0.8125rem; margin-left: 0;\"><span class=\"f_Normal\" style=\"font-family: Arial,\'Lucida Sans Unicode\',\'Lucida Grande\',\'Lucida Sans\';display:inline-block;width:0.8125rem;margin-left:-0.8125rem\">&#8226;<\/span>IPR read\/write paths<\/p>\n\r<p class=\"p_Normal\" style=\"text-indent: 0; padding-left: 0.8125rem; margin-left: 0;\"><span class=\"f_Normal\" style=\"font-family: Arial,\'Lucida Sans Unicode\',\'Lucida Grande\',\'Lucida Sans\';display:inline-block;width:0.8125rem;margin-left:-0.8125rem\">&#8226;<\/span>PTBR\/VA_CTL\/VA_FORM<\/p>\n\r<p class=\"p_Normal\" style=\"text-indent: 0; padding-left: 0.8125rem; margin-left: 0;\"><span class=\"f_Normal\" style=\"font-family: Arial,\'Lucida Sans Unicode\',\'Lucida Grande\',\'Lucida Sans\';display:inline-block;width:0.8125rem;margin-left:-0.8125rem\">&#8226;<\/span>Stack manipulation<\/p>\n\r<p class=\"p_Normal\" style=\"text-indent: 0; padding-left: 0.8125rem; margin-left: 0;\"><span class=\"f_Normal\" style=\"font-family: Arial,\'Lucida Sans Unicode\',\'Lucida Grande\',\'Lucida Sans\';display:inline-block;width:0.8125rem;margin-left:-0.8125rem\">&#8226;<\/span>CM\/PS tracking<\/p>\n\r<p class=\"p_Normal\" style=\"text-indent: 0; padding-left: 0.8125rem; margin-left: 0;\"><span class=\"f_Normal\" style=\"font-family: Arial,\'Lucida Sans Unicode\',\'Lucida Grande\',\'Lucida Sans\';display:inline-block;width:0.8125rem;margin-left:-0.8125rem\">&#8226;<\/span>Memory barriers (MB\/WMB)<\/p>\n\r<p class=\"p_Normal\" style=\"text-indent: 0; padding-left: 0.8125rem; margin-left: 0;\"><span class=\"f_Normal\" style=\"font-family: Arial,\'Lucida Sans Unicode\',\'Lucida Grande\',\'Lucida Sans\';display:inline-block;width:0.8125rem;margin-left:-0.8125rem\">&#8226;<\/span>REI \/ CHME \/ CHMS transitions<\/p>\n\r<p class=\"p_Normal\" style=\"text-indent: 0; padding-left: 0.8125rem; margin-left: 0;\"><span class=\"f_Normal\" style=\"font-family: Arial,\'Lucida Sans Unicode\',\'Lucida Grande\',\'Lucida Sans\';display:inline-block;width:0.8125rem;margin-left:-0.8125rem\">&#8226;<\/span>DTB <\/p>\n\r<p class=\"p_Normal\" style=\"text-indent: 0; padding-left: 0.8125rem; margin-left: 0;\"><span class=\"f_Normal\" style=\"font-family: Arial,\'Lucida Sans Unicode\',\'Lucida Grande\',\'Lucida Sans\';display:inline-block;width:0.8125rem;margin-left:-0.8125rem\">&#8226;<\/span>Load \/ Store Operations <\/p>\n\r<p class=\"p_Normal\" style=\"text-indent: 0; padding-left: 0.8125rem; margin-left: 0;\"><span class=\"f_Normal\" style=\"font-family: Arial,\'Lucida Sans Unicode\',\'Lucida Grande\',\'Lucida Sans\';display:inline-block;width:0.8125rem;margin-left:-0.8125rem\">&#8226;<\/span>PAL Code execution<\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">&nbsp;<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">+-------------------------------------------+<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MBox&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">|-------------------------------------------|<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">|&nbsp;-&nbsp;SafeMemory&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">|&nbsp;-&nbsp;ITB\/DTB&nbsp;staging&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">|&nbsp;-&nbsp;Load\/Store&nbsp;queues&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">|&nbsp;-&nbsp;PAL&nbsp;entry&nbsp;and&nbsp;execution&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">|&nbsp;-&nbsp;IPR&nbsp;read\/write&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">|&nbsp;-&nbsp;Fault&nbsp;generation&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">|&nbsp;-&nbsp;AST&nbsp;generation&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">|-------------------------------------------|<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">|&nbsp;execute(slot)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">+-------------------------------------------+<\/span><\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r"
})
