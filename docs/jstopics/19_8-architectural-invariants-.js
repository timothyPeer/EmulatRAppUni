hmLoadTopic({
hmKeywords:"",
hmTitle:"19.8 Architectural Invariants (Normative)",
hmDescription:"The following invariants govern the interrupt and IPI subsystem. Violation of any invariant breaks SMP correctness.",
hmPrevLink:"19_7-tlb-shootdown-protocol.html",
hmNextLink:"19_9-repository-directory-mapp.html",
hmParentLink:"chapter-19---debugging_-tracin.html",
hmBreadCrumbs:"<a href=\"index.html\">Introduction<\/a> &gt; <a href=\"architecture-overview.html\">Architecture Overview<\/a> &gt; <a href=\"chapter-19---debugging_-tracin.html\">Chapter 19 – Interrupt Architecture &amp; IPI<\/a>",
hmTitlePath:"Introduction > Architecture Overview > Chapter 19 – Interrupt Architecture & IPI > 19.8 Architectural Invariants (Normative)",
hmHeader:"<h1 class=\"p_Heading1\" style=\"page-break-after: avoid;\"><span class=\"f_Heading1\">19.8 Architectural Invariants (Normative)<\/span><\/h1>\n\r",
hmBody:"<p class=\"p_Normal\">The following invariants govern the interrupt and IPI subsystem. Violation of any invariant breaks SMP correctness.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><span style=\"font-weight: bold;\">Unified Interrupt Path:<\/span> All interrupts — device, software, IPI — flow through <span class=\"f_CodeExample\">IRQPendingState<\/span> and the same PAL delivery mechanism. No interrupt source may bypass this path.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><span style=\"font-weight: bold;\">Interrupt Sampling:<\/span> Interrupts are sampled at instruction boundaries, never mid-instruction. The sampling point is the pre-cycle phase of the CPU run loop, after barrier release checks.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><span style=\"font-weight: bold;\">Fault Priority:<\/span> Synchronous faults always outrank interrupts. If a fault is pending in the FaultDispatcher, interrupt delivery is blocked until the fault is resolved.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><span style=\"font-weight: bold;\">PAL Serialization:<\/span> All interrupt handlers are PAL code. Interrupt delivery serializes the pipeline and enters PAL mode. No interrupt handler exists outside PAL.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><span style=\"font-weight: bold;\">No Lost Interrupts:<\/span> Level-triggered interrupts remain pending until claimed and serviced. Edge-triggered interrupts are recorded on assertion. The <span class=\"f_CodeExample\">IRQPendingState<\/span> atomic operations ensure no interrupt is lost due to race conditions between device threads and the CPU thread.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><span style=\"font-weight: bold;\">IPI Explicitness:<\/span> IPIs are per-CPU and explicit. Every IPI has a defined source CPU, target CPU, and command. No implicit cross-CPU interrupt generation occurs.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><span style=\"font-weight: bold;\">Reservation Clearing:<\/span> LL\/SC reservations are cleared on every interrupt delivery and PAL mode entry. No STx_C may succeed across an interrupt boundary.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><span style=\"font-weight: bold;\">Barrier Ordering:<\/span> Interrupt delivery does not bypass memory ordering. Barriers ensure all memory effects complete before interrupt handling. Interrupt handlers see consistent memory state.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><span style=\"font-weight: bold;\">Shootdown Synchrony:<\/span> TLB shootdown via IPI is serialized — the initiating CPU stalls until all target CPUs have acknowledged. No CPU may execute with a stale TLB entry after shootdown completion.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><span style=\"font-weight: bold;\">Per-CPU Independence:<\/span> Each CPU handles interrupts independently. There is no global interrupt lock. Cross-CPU coordination uses only atomic operations, IPIs, and the MemoryBarrierCoordinator.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_SeeAlso\" style=\"page-break-after: avoid;\"><span class=\"f_SeeAlso\">See Also: <a href=\"chapter-11---architectural-inv.html\" class=\"topiclink\">Chapter 11 - Architectural Invariants<\/a> (complete invariant reference).<\/span><\/p>\n\r"
})
