hmLoadTopic({
hmKeywords:"",
hmTitle:"17.1 Alpha Virtual Address Format",
hmDescription:"17.1.1 VA Structure  The Alpha AXP virtual address format is implementation-dependent, selected at CPU\/board bring-up, not inferred from VA bits. The format is determined by two",
hmPrevLink:"chapter-17---tlb_-pte_-and-add.html",
hmNextLink:"17_2-pte-representation.html",
hmParentLink:"chapter-17---tlb_-pte_-and-add.html",
hmBreadCrumbs:"<a href=\"index.html\">Introduction<\/a> &gt; <a href=\"architecture-overview.html\">Architecture Overview<\/a> &gt; <a href=\"chapter-17---tlb_-pte_-and-add.html\">Chapter 17 – Address Translation, TLB, and PTE<\/a>",
hmTitlePath:"Introduction > Architecture Overview > Chapter 17 – Address Translation, TLB, and PTE > 17.1 Alpha Virtual Address Format",
hmHeader:"<h1 class=\"p_Heading1\" style=\"page-break-after: avoid;\"><span class=\"f_Heading1\">17.1 Alpha Virtual Address Format<\/span><\/h1>\n\r",
hmBody:"<h2 class=\"p_Heading2\" style=\"page-break-after: avoid;\"><span class=\"f_Heading2\">17.1.1 VA Structure<\/span><\/h2>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">The Alpha AXP virtual address format is implementation-dependent, selected at CPU\/board bring-up, not inferred from VA bits. The format is determined by two configuration inputs: <span class=\"f_CodeExample\">pageShift<\/span> (byte-within-page field width: 13, 14, 15, or 16 bits) and <span class=\"f_CodeExample\">levelBits<\/span> (Level2 and Level3 field widths: 10, 11, 12, or 13 bits). The implemented VA width (<span class=\"f_CodeExample\">vaBits<\/span>) varies by page size option.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">All VA formats use the same three-level page table structure with a 2-bit segment field:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">&nbsp;[Segment&nbsp;2b]&nbsp;[L1&nbsp;variable]&nbsp;[L2&nbsp;levelBits]&nbsp;[L3&nbsp;levelBits]&nbsp;[Offset&nbsp;pageShift]<\/span><\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Derived field boundaries:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">&nbsp;offsetMask&nbsp;=&nbsp;(1ULL&nbsp;&lt;&lt;&nbsp;pageShift)&nbsp;-&nbsp;1<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">&nbsp;Segment&nbsp;=&nbsp;VA[vaBits-1&nbsp;:&nbsp;vaBits-2]&nbsp;\/\/&nbsp;2&nbsp;bits,&nbsp;always<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">&nbsp;L1&nbsp;=&nbsp;VA[vaBits-3&nbsp;:&nbsp;pageShift&nbsp;+&nbsp;2*levelBits]<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">&nbsp;L1&nbsp;width&nbsp;=&nbsp;vaBits&nbsp;-&nbsp;2&nbsp;-&nbsp;(pageShift&nbsp;+&nbsp;2*levelBits)<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">&nbsp;L2&nbsp;=&nbsp;VA[pageShift&nbsp;+&nbsp;2*levelBits&nbsp;-&nbsp;1&nbsp;:&nbsp;pageShift&nbsp;+&nbsp;levelBits]<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">&nbsp;L3&nbsp;=&nbsp;VA[pageShift&nbsp;+&nbsp;levelBits&nbsp;-&nbsp;1&nbsp;:&nbsp;pageShift]<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">&nbsp;Offset&nbsp;=&nbsp;VA[pageShift&nbsp;-&nbsp;1&nbsp;:&nbsp;0]<\/span><\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Canonicality constraint: in a 64-bit VA register, bits above <span class=\"f_CodeExample\">(vaBits-1)<\/span> must be a sign-extension of bit <span class=\"f_CodeExample\">(vaBits-1)<\/span>. Non-canonical addresses produce a translation fault.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<hr style=\"height:1px; color:#000000; border-width:0; background-color:#000000;\" \/><p class=\"p_Normal\">&nbsp;<\/p>\n\r<h2 class=\"p_Heading2\" style=\"page-break-after: avoid;\"><span class=\"f_Heading2\">17.1.2 Page Size Options<\/span><\/h2>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<div style=\"text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;\"><table style=\"border:none; border-spacing:0; border-collapse:collapse;\">\n\r<thead>\n\r<tr>\n\r<th style=\"vertical-align:top; background-color:#00FFFF; padding:0; border:solid thin #000000;\" scope=\"col\"><p class=\"p_Normal\"><span style=\"font-weight: bold;\">Option<\/span><\/p>\n\r<\/th>\n\r<th style=\"vertical-align:top; background-color:#00FFFF; padding:0; border:solid thin #000000;\" scope=\"col\"><p class=\"p_Normal\"><span style=\"font-weight: bold;\">Page Size<\/span><\/p>\n\r<\/th>\n\r<th style=\"vertical-align:top; background-color:#00FFFF; padding:0; border:solid thin #000000;\" scope=\"col\"><p class=\"p_Normal\"><span style=\"font-weight: bold;\">pageShift<\/span><\/p>\n\r<\/th>\n\r<th style=\"vertical-align:top; background-color:#00FFFF; padding:0; border:solid thin #000000;\" scope=\"col\"><p class=\"p_Normal\"><span style=\"font-weight: bold;\">levelBits<\/span><\/p>\n\r<\/th>\n\r<th style=\"vertical-align:top; background-color:#00FFFF; padding:0; border:solid thin #000000;\" scope=\"col\"><p class=\"p_Normal\"><span style=\"font-weight: bold;\">vaBits<\/span><\/p>\n\r<\/th>\n\r<th style=\"vertical-align:top; background-color:#00FFFF; padding:0; border:solid thin #000000;\" scope=\"col\"><p class=\"p_Normal\"><span style=\"font-weight: bold;\">L1 Width<\/span><\/p>\n\r<\/th>\n\r<\/tr>\n\r<\/thead>\n\r<tbody>\n\r<tr>\n\r<td style=\"vertical-align:top; padding:0; border:solid thin #000000;\"><p class=\"p_Normal\">A<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; padding:0; border:solid thin #000000;\"><p class=\"p_Normal\">8K<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; padding:0; border:solid thin #000000;\"><p class=\"p_Normal\">13<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; padding:0; border:solid thin #000000;\"><p class=\"p_Normal\">10<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; padding:0; border:solid thin #000000;\"><p class=\"p_Normal\">43 (fixed)<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; padding:0; border:solid thin #000000;\"><p class=\"p_Normal\">8 (fixed)<\/p>\n\r<\/td>\n\r<\/tr>\n\r<tr>\n\r<td style=\"vertical-align:top; padding:0; border:solid thin #000000;\"><p class=\"p_Normal\">B<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; padding:0; border:solid thin #000000;\"><p class=\"p_Normal\">16K<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; padding:0; border:solid thin #000000;\"><p class=\"p_Normal\">14<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; padding:0; border:solid thin #000000;\"><p class=\"p_Normal\">11<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; padding:0; border:solid thin #000000;\"><p class=\"p_Normal\">43–47<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; padding:0; border:solid thin #000000;\"><p class=\"p_Normal\">5–9<\/p>\n\r<\/td>\n\r<\/tr>\n\r<tr>\n\r<td style=\"vertical-align:top; padding:0; border:solid thin #000000;\"><p class=\"p_Normal\">C<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; padding:0; border:solid thin #000000;\"><p class=\"p_Normal\">32K<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; padding:0; border:solid thin #000000;\"><p class=\"p_Normal\">15<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; padding:0; border:solid thin #000000;\"><p class=\"p_Normal\">12<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; padding:0; border:solid thin #000000;\"><p class=\"p_Normal\">43–51<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; padding:0; border:solid thin #000000;\"><p class=\"p_Normal\">2–10<\/p>\n\r<\/td>\n\r<\/tr>\n\r<tr>\n\r<td style=\"vertical-align:top; padding:0; border:solid thin #000000;\"><p class=\"p_Normal\">D<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; padding:0; border:solid thin #000000;\"><p class=\"p_Normal\">64K<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; padding:0; border:solid thin #000000;\"><p class=\"p_Normal\">16<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; padding:0; border:solid thin #000000;\"><p class=\"p_Normal\">13<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; padding:0; border:solid thin #000000;\"><p class=\"p_Normal\">46–55<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; padding:0; border:solid thin #000000;\"><p class=\"p_Normal\">2–11<\/p>\n\r<\/td>\n\r<\/tr>\n\r<\/tbody>\n\r<\/table>\n\r<\/div>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Note for Option D: the architecture states vaBits=44–55, but at vaBits=44 the L1 width is 0 bits, violating the minimum-2-bits-of-L1 constraint. In practice, vaBits must be ≥ 46 for 64K pages.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<hr style=\"height:1px; color:#000000; border-width:0; background-color:#000000;\" \/><p class=\"p_Normal\">&nbsp;<\/p>\n\r<h2 class=\"p_Heading2\" style=\"page-break-after: avoid;\"><span class=\"f_Heading2\">17.1.3 Configuration and TLB Lookup<\/span><\/h2>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">The VA option is selected once at configuration time via <span class=\"f_CodeExample\">Ev6SiliconConfig<\/span>, which sets <span class=\"f_CodeExample\">basePageSize<\/span> from the system configuration. The TLB lookup uses <span class=\"f_CodeExample\">VPN = VA &gt;&gt; pageShift<\/span> plus ASN, global flag, and mode checks. Do not scan VA options on every lookup — decode VA fields according to the selected option only. If mixed page sizes are later supported, page size becomes an attribute of the TLB entry (<span class=\"f_CodeExample\">pageMask<\/span>), not something inferred by reinterpreting VA field boundaries.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_SeeAlso\" style=\"page-break-after: avoid;\"><span class=\"f_SeeAlso\">See Also: <a href=\"chapter-5_4-virtual-addressing.html\" class=\"topiclink\">5.4 Virtual Addressing and Translation<\/a>; <a href=\"alpha-va-format-contract.html\" class=\"topiclink\">5.4.4 Alpha VA Field Boundary Reference<\/a>; Alpha AXP Architecture Reference Manual v6, Chapter 22.<\/span><\/p>\n\r"
})
