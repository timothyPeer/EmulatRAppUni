hmLoadTopic({
hmKeywords:"Address,Alignment,Boundary,Box,CBox,Classification,Coherency,Commit,commitPending,Decode,Delegation,Dispatch,Displacement,DTB,EBox,Ev6Translator,ExecUnit,Execute,Execution,executionBoxDecoder,FBox,FloatingPoint,Flow,Frontend,Grain,GrainResolver,GuestMemory,IBox,IBox,Initialization,Injection,Instruction,Integer,Interaction,Isolation,LDQ,Lifecycle,Load,MBox,Memory,needsWriteback,Opcode,PalBox,payLoad,Pipeline,PipelineSlot,Pointer,Privilege,ProgramCounter,R1,R2,read64,Register,RegisterFile,Result,Retirement,Routing,Serialization,Slot,Stage,Translation",
hmTitle:"4.3 Execution Flow: Grains, Pipeline, and Boxes",
hmDescription:"4.3.1 Execution Flow Summary  Execution always follows this pattern: Instruction is decoded into a Grain by IBox (via GrainResolver) Grain enters the pipeline, populating a Pip",
hmPrevLink:"chapter-4_2-box-based-executio.html",
hmNextLink:"chapter-4_4-ibox---instruction.html",
hmParentLink:"chapter-4---functionexecution-.html",
hmBreadCrumbs:"<a href=\"license-_-attributions.html\">ASA-EMulatR Reference Guide<\/a> &gt; <a href=\"index.html\">Introduction<\/a> &gt; <a href=\"architecture-overview.html\">Architecture Overview<\/a> &gt; <a href=\"chapter-4---functionexecution-.html\">Chapter 4 - Functional Execution Domains (&quot;Boxes)<\/a>",
hmTitlePath:"ASA-EMulatR Reference Guide > Introduction > Architecture Overview > Chapter 4 - Functional Execution Domains (\"Boxes) > 4.3 Execution Flow: Grains, Pipeline, and Boxes",
hmHeader:"<h1 class=\"p_Heading1\" style=\"page-break-after: avoid;\"><span class=\"f_Heading1\">4.3 Execution Flow: Grains, Pipeline, and Boxes<\/span><\/h1>\n\r",
hmBody:"<h2 class=\"p_Heading2\" style=\"page-break-after: avoid;\"><span class=\"f_Heading2\">4.3.1 Execution Flow Summary<\/span><\/h2>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Execution always follows this pattern:<\/p>\n\r<p class=\"p_Normal\" style=\"text-indent: 0; padding-left: 1.2500rem; margin-left: 0;\"><span class=\"f_Normal\" style=\"display:inline-block;width:1.2500rem;margin-left:-1.2500rem\">1.<\/span>Instruction is decoded into a Grain by IBox (via GrainResolver)<\/p>\n\r<p class=\"p_Normal\" style=\"text-indent: 0; padding-left: 1.2500rem; margin-left: 0;\"><span class=\"f_Normal\" style=\"display:inline-block;width:1.2500rem;margin-left:-1.2500rem\">2.<\/span>Grain enters the pipeline, populating a PipelineSlot<\/p>\n\r<p class=\"p_Normal\" style=\"text-indent: 0; padding-left: 1.2500rem; margin-left: 0;\"><span class=\"f_Normal\" style=\"display:inline-block;width:1.2500rem;margin-left:-1.2500rem\">3.<\/span>In the Execute (EX) stage, the grain\'s execute() method runs<\/p>\n\r<p class=\"p_Normal\" style=\"text-indent: 0; padding-left: 1.2500rem; margin-left: 0;\"><span class=\"f_Normal\" style=\"display:inline-block;width:1.2500rem;margin-left:-1.2500rem\">4.<\/span>The grain dispatches work to one or more Boxes<\/p>\n\r<p class=\"p_Normal\" style=\"text-indent: 0; padding-left: 1.2500rem; margin-left: 0;\"><span class=\"f_Normal\" style=\"display:inline-block;width:1.2500rem;margin-left:-1.2500rem\">5.<\/span>Boxes perform architectural actions synchronously, writing results into the slot<\/p>\n\r<p class=\"p_Normal\" style=\"text-indent: 0; padding-left: 1.2500rem; margin-left: 0;\"><span class=\"f_Normal\" style=\"display:inline-block;width:1.2500rem;margin-left:-1.2500rem\">6.<\/span>Results flow through MEM (deferred register commit) to WB (store commit, retirement)<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Boxes never call the pipeline and never call other Boxes directly unless explicitly allowed by the interaction rules.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<hr style=\"height:1px; color:#000000; border-width:0; background-color:#000000;\" \/><p class=\"p_Normal\">&nbsp;<\/p>\n\r<h2 class=\"p_Heading2\" style=\"page-break-after: avoid;\"><span class=\"f_Heading2\">4.3.2 Box Routing<\/span><\/h2>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Each PipelineSlot carries pointers to all five Boxes (m_eBox, m_fBox, m_mBox, m_palBox, m_cBox), injected once during pipeline initialization. The Decode stage (DE) classifies each instruction into its target Box via executionBoxDecoder(opCode), setting the slot\'s execUnit field. This routing determines which Box the grain\'s execute() method will call.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">The six Box types and their ExecUnit identifiers:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">IBox (ExecUnit::IBOX) — Instruction frontend only, never called during EX<\/p>\n\r<p class=\"p_Normal\">EBox (ExecUnit::EBOX) — Integer and control-flow execution<\/p>\n\r<p class=\"p_Normal\">FBox (ExecUnit::FBOX) — Floating-point execution<\/p>\n\r<p class=\"p_Normal\">MBox (ExecUnit::MBOX) — Memory access execution<\/p>\n\r<p class=\"p_Normal\">CBox (ExecUnit::CBOX) — Serialization and coherency<\/p>\n\r<p class=\"p_Normal\">PalBox (ExecUnit::PALBOX) — Privileged execution<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<hr style=\"height:1px; color:#000000; border-width:0; background-color:#000000;\" \/><p class=\"p_Normal\">&nbsp;<\/p>\n\r<h2 class=\"p_Heading2\" style=\"page-break-after: avoid;\"><span class=\"f_Heading2\">4.3.3 Execution Flow Example: LDQ R1, 0(R2)<\/span><\/h2>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">IBox:<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">&nbsp;-&nbsp;Fetch&nbsp;instruction&nbsp;at&nbsp;current&nbsp;PC<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">&nbsp;-&nbsp;Decode&nbsp;raw&nbsp;bits&nbsp;→&nbsp;GrainResolver&nbsp;resolves&nbsp;to&nbsp;LDQ&nbsp;grain<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">&nbsp;-&nbsp;Cache&nbsp;grain&nbsp;in&nbsp;InstructionGrainRegistry<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">&nbsp;<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">Pipeline&nbsp;EX&nbsp;(grain-&gt;execute()):<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">&nbsp;→&nbsp;MBox::executeLDQ(slot)<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">&nbsp;-&nbsp;Calculate&nbsp;EA:&nbsp;slot.va&nbsp;=&nbsp;Rb&nbsp;+&nbsp;SEXT(disp)<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">&nbsp;-&nbsp;Check&nbsp;alignment&nbsp;(8-byte&nbsp;for&nbsp;LDQ)<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">&nbsp;-&nbsp;Translate&nbsp;VA&nbsp;→&nbsp;PA&nbsp;via&nbsp;Ev6Translator&nbsp;(DTB&nbsp;lookup)<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">&nbsp;-&nbsp;Read&nbsp;from&nbsp;GuestMemory:&nbsp;m_guestMemory-&gt;read64(pa)<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">&nbsp;-&nbsp;Store&nbsp;result:&nbsp;slot.payLoad&nbsp;=&nbsp;data<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">&nbsp;-&nbsp;Set:&nbsp;slot.needsWriteback&nbsp;=&nbsp;true<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">&nbsp;<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">Pipeline&nbsp;MEM:<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">&nbsp;-&nbsp;commitPending()&nbsp;writes&nbsp;previous&nbsp;cycle\'s&nbsp;result&nbsp;to&nbsp;register&nbsp;file<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">&nbsp;<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">Pipeline&nbsp;WB:<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">&nbsp;-&nbsp;Register&nbsp;R1&nbsp;updated&nbsp;with&nbsp;slot.payLoad<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">&nbsp;-&nbsp;Instruction&nbsp;retired<\/span><\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">No other Box participates. EBox is not involved because MBox handles the entire load operation including address calculation.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_SeeAlso\" style=\"page-break-after: avoid;\"><span class=\"f_SeeAlso\">See Also: <a href=\"chapter-3_7-execute-stage-(ex).html\" class=\"topiclink\">3.7 Execute Stage (EX)<\/a>; <a href=\"3_16-grain-system-chapter3.html\" class=\"topiclink\">3.16 Grain System<\/a>.<\/span><\/p>\n\r"
})
