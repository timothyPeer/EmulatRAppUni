hmLoadTopic({
hmKeywords:"",
hmTitle:"IRQController",
hmDescription:"IRQ Routing Requirements IRQ-REQ-001: Provide per-vector routing policy (FIXED_CPU, ROUND_ROBIN, LOWEST_IPL, BROADCAST). IRQ-REQ-002: Store per-vector hose\/device metadata for",
hmPrevLink:"",
hmNextLink:"",
hmParentLink:"appendix---trait-examples.html",
hmBreadCrumbs:"",
hmTitlePath:"ASA-EMulatR Reference Guide > Introduction > Appendix > Appendix I – Glossary and Acronyms",
hmHeader:"<h1 class=\"p_Heading1\" style=\"page-break-after: avoid;\"><span class=\"f_Heading1\">IRQController<\/span><\/h1>\n\r",
hmBody:"<p class=\"p_Normal\"><strong style=\"font-weight: bold;\">IRQ Routing Requirements<\/strong><\/p>\n\r<div style=\"text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;\"><table style=\"border:none; border-spacing:0;\">\n\r<tr>\n\r<td style=\"vertical-align:top; width:6.5000rem; padding:0; border:none\"><p class=\"p_Normal\">IRQ-REQ-001:<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:49.0625rem; padding:0; border:none\"><p class=\"p_Normal\">Provide per-vector routing policy (FIXED_CPU, ROUND_ROBIN, LOWEST_IPL, BROADCAST).<\/p>\n\r<\/td>\n\r<\/tr>\n\r<tr>\n\r<td style=\"vertical-align:top; width:6.5000rem; padding:0; border:none\"><p class=\"p_Normal\">IRQ-REQ-002:<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:49.0625rem; padding:0; border:none\"><p class=\"p_Normal\">Store per-vector hose\/device metadata for SCSI\/NIC\/IO routes.<\/p>\n\r<\/td>\n\r<\/tr>\n\r<tr>\n\r<td style=\"vertical-align:top; width:6.5000rem; padding:0; border:none\"><p class=\"p_Normal\">IRQ-REQ-003:<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:49.0625rem; padding:0; border:none\"><p class=\"p_Normal\">Deliver interrupts to target CPU using the correct policy.<\/p>\n\r<\/td>\n\r<\/tr>\n\r<\/table>\n\r<\/div>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><strong style=\"font-weight: bold;\">Pending Interrupt Tracking<\/strong><\/p>\n\r<div style=\"text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;\"><table style=\"border:none; border-spacing:0;\">\n\r<tr>\n\r<td style=\"vertical-align:top; width:6.6875rem; padding:0; border:none\"><p class=\"p_Normal\">IRQ-REQ-010:<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:48.8125rem; padding:0; border:none\"><p class=\"p_Normal\">Track pending interrupts using an atomic bitmask (pendingIPLMask).<\/p>\n\r<\/td>\n\r<\/tr>\n\r<tr>\n\r<td style=\"vertical-align:top; width:6.6875rem; padding:0; border:none\"><p class=\"p_Normal\">IRQ-REQ-011:<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:48.8125rem; padding:0; border:none\"><p class=\"p_Normal\">Track per-IPL FIFO queue of posted vectors.<\/p>\n\r<\/td>\n\r<\/tr>\n\r<tr>\n\r<td style=\"vertical-align:top; width:6.6875rem; padding:0; border:none\"><p class=\"p_Normal\">IRQ-REQ-012:<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:48.8125rem; padding:0; border:none\"><p class=\"p_Normal\">Provide lock-free fast-path read (hasPendingInterrupt()).<\/p>\n\r<\/td>\n\r<\/tr>\n\r<\/table>\n\r<\/div>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><strong style=\"font-weight: bold;\">Interrupt Dispatch Requirements<\/strong><\/p>\n\r<div style=\"text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;\"><table style=\"border:none; border-spacing:0;\">\n\r<tr>\n\r<td style=\"vertical-align:top; width:6.6875rem; padding:0; border:none\"><p class=\"p_Normal\">IRQ-REQ-020:<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:48.8125rem; padding:0; border:none\"><p class=\"p_Normal\">getNextInterrupt() must: Acquire lock, Pop FIFO vector, Clear bit if queue empty, Return highest pending IPL.<\/p>\n\r<\/td>\n\r<\/tr>\n\r<\/table>\n\r<\/div>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><strong style=\"font-weight: bold;\">IPI Support<\/strong><\/p>\n\r<div style=\"text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;\"><table style=\"border:none; border-spacing:0;\">\n\r<tr>\n\r<td style=\"vertical-align:top; width:6.6250rem; padding:0; border:none\"><p class=\"p_Normal\">IRQ-REQ-030:<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:48.8750rem; padding:0; border:none\"><p class=\"p_Normal\">Support reservation-break IPI vector (0x510) at IPL 20.<\/p>\n\r<\/td>\n\r<\/tr>\n\r<tr>\n\r<td style=\"vertical-align:top; width:6.6250rem; padding:0; border:none\"><p class=\"p_Normal\">IRQ-REQ-031:<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:48.8750rem; padding:0; border:none\"><p class=\"p_Normal\">Provide sendIPI(source, targetCPU, ipl, vector) for SMP coordination.<\/p>\n\r<\/td>\n\r<\/tr>\n\r<tr>\n\r<td style=\"vertical-align:top; width:6.6250rem; padding:0; border:none\"><p class=\"p_Normal\">IRQ-REQ-032:<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:48.8750rem; padding:0; border:none\"><p class=\"p_Normal\">Broadcast IPIs must skip source CPU.<\/p>\n\r<\/td>\n\r<\/tr>\n\r<\/table>\n\r<\/div>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">PTE - SPAMShardManager<\/p>\n\r<div style=\"text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;\"><table style=\"border:none; border-spacing:0;\">\n\r<tr>\n\r<td style=\"vertical-align:top; width:6.2500rem; padding:0; border:none\"><p class=\"p_Normal\">IPI-REQ_050<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:142.3750rem; padding:0; border:none\"><p class=\"p_Normal\">I<\/p>\n\r<p class=\"p_Normal\">ntegrate IPI handling into IRQController (with clear internal layering)<\/p>\n\r<p class=\"p_Normal\">– Single Meyers singleton: globalIRQController()<\/p>\n\r<p class=\"p_Normal\">– Internally:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Per-CPU CPUIRQState with IPI bits\/vectors<\/p>\n\r<p class=\"p_Normal\">Device IRQs + IPIs share the same “interrupt fabric”<\/p>\n\r<p class=\"p_Normal\">AlphaCPU calls checkPendingInterrupts() → consults IRQController (including IPI state)<\/p>\n\r<p class=\"p_Normal\">When you’re ready to work that item, we can:<\/p>\n\r<p class=\"p_Normal\">Refine CPUIRQState to include IPI queues\/vectors.<\/p>\n\r<p class=\"p_Normal\">Add sendIPI(), broadcastIPI(), and a clean handleIPIForCPU(cpuId) entrypoint.<\/p>\n\r<p class=\"p_Normal\">Wire AlphaCPU’s checkPendingInterrupts() to call that handler.<\/p>\n\r<p class=\"p_Normal\">Hook PAL TBIA\/TBIAP → broadcast IPI → per-CPU Ev6PteCache invalidation.<\/p>\n\r<p class=\"p_Normal\">And tomorrow’s plan you mentioned:<\/p>\n\r<\/td>\n\r<\/tr>\n\r<tr>\n\r<td style=\"vertical-align:top; width:6.2500rem; padding:0; border:none\"><p class=\"p_Normal\">ReservationManager<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:142.3750rem; padding:0; border:none\"><p class=\"p_Normal\">Trap \/ Exception \/ AST \/ Mode change<\/p>\n\r<\/td>\n\r<\/tr>\n\r<\/table>\n\r<\/div>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<div style=\"text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;\"><table style=\"border:none; border-spacing:0;\">\n\r<tr>\n\r<td style=\"vertical-align:top; width:10.0000rem; padding:0; border:none\"><p class=\"p_Normal\">ReservationManager<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:77.3750rem; padding:0; border:none\"><p class=\"p_Normal\">ReservationManager::instance().clearReservation(cpuId); Interrupt delivery during STx_C window; If an interrupt is taken before SC completes:Local reservation clear. EV6 rule: Any interrupt kills LL.<\/p>\n\r<\/td>\n\r<\/tr>\n\r<\/table>\n\r<\/div>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><strong style=\"font-weight: bold;\">ASTs; <\/strong><\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><span style=\"width:3.0000rem;display:inline-block\">&nbsp;<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; color: #008000; background-color: #ffffff;\">\/\/ ASTRR<\/span><\/p>\n\r<p class=\"p_Normal\"><span style=\"width:3.0000rem;display:inline-block\">&nbsp;<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; color: #0000ff; background-color: #ffffff;\">inline<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; background-color: #ffffff;\">&nbsp;<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; color: #2b91af; background-color: #ffffff;\">quint64<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; background-color: #ffffff;\">&nbsp;<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; color: #880000; background-color: #ffffff;\">getASTRR<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; background-color: #ffffff;\">()&nbsp;<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; color: #0000ff; background-color: #ffffff;\">const<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; background-color: #ffffff;\">&nbsp;<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; color: #0000ff; background-color: #ffffff;\">noexcept<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; background-color: #ffffff;\">&nbsp;{&nbsp;<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; color: #0000ff; background-color: #ffffff;\">return<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; background-color: #ffffff;\">&nbsp;<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; color: #000080; background-color: #ffffff;\">astrr<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; background-color: #ffffff;\">; }<\/span><\/p>\n\r<p class=\"p_Normal\"><span style=\"width:3.0000rem;display:inline-block\">&nbsp;<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; color: #0000ff; background-color: #ffffff;\">inline<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; background-color: #ffffff;\">&nbsp;<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; color: #0000ff; background-color: #ffffff;\">void<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; background-color: #ffffff;\">&nbsp;<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; color: #880000; background-color: #ffffff;\">setASTRR<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; background-color: #ffffff;\">(<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; color: #0000ff; background-color: #ffffff;\">const<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; background-color: #ffffff;\">&nbsp;<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; color: #000080; background-color: #ffffff;\">quint64<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; background-color: #ffffff;\">&nbsp;<\/span><strong style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; font-weight: bold; color: #000080; background-color: #ffffff;\">astRR<\/strong><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; background-color: #ffffff;\">) {&nbsp;<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; color: #000080; background-color: #ffffff;\">astrr<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; background-color: #ffffff;\">&nbsp;=&nbsp;<\/span><strong style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; font-weight: bold; color: #000080; background-color: #ffffff;\">astRR<\/strong><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; background-color: #ffffff;\">; }<\/span><\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><span style=\"width:3.0000rem;display:inline-block\">&nbsp;<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; color: #008000; background-color: #ffffff;\">\/\/ ASTSR<\/span><\/p>\n\r<p class=\"p_Normal\"><span style=\"width:3.0000rem;display:inline-block\">&nbsp;<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; color: #0000ff; background-color: #ffffff;\">inline<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; background-color: #ffffff;\">&nbsp;<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; color: #2b91af; background-color: #ffffff;\">quint64<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; background-color: #ffffff;\">&nbsp;<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; color: #880000; background-color: #ffffff;\">getASTSR<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; background-color: #ffffff;\">()&nbsp;<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; color: #0000ff; background-color: #ffffff;\">const<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; background-color: #ffffff;\">&nbsp;<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; color: #0000ff; background-color: #ffffff;\">noexcept<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; background-color: #ffffff;\">&nbsp;{&nbsp;<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; color: #0000ff; background-color: #ffffff;\">return<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; background-color: #ffffff;\">&nbsp;<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; color: #000080; background-color: #ffffff;\">astsr<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; background-color: #ffffff;\">; }<\/span><\/p>\n\r<p class=\"p_Normal\"><span style=\"width:3.0000rem;display:inline-block\">&nbsp;<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; color: #0000ff; background-color: #ffffff;\">inline<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; background-color: #ffffff;\">&nbsp;<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; color: #0000ff; background-color: #ffffff;\">void<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; background-color: #ffffff;\">&nbsp;<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; color: #880000; background-color: #ffffff;\">setASTSR<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; background-color: #ffffff;\">(<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; color: #2b91af; background-color: #ffffff;\">quint64<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; background-color: #ffffff;\">&nbsp;<\/span><strong style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; font-weight: bold; color: #000080; background-color: #ffffff;\">value<\/strong><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; background-color: #ffffff;\">)&nbsp;<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; color: #0000ff; background-color: #ffffff;\">noexcept<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; background-color: #ffffff;\">&nbsp;{&nbsp;<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; color: #000080; background-color: #ffffff;\">astsr<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; background-color: #ffffff;\">&nbsp;=&nbsp;<\/span><strong style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; font-weight: bold; color: #000080; background-color: #ffffff;\">value<\/strong><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; background-color: #ffffff;\">; }<\/span><\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><span style=\"width:3.0000rem;display:inline-block\">&nbsp;<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; color: #2b91af; background-color: #e0ffff;\">quint64<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; background-color: #ffffff;\">&nbsp;<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; color: #000080; background-color: #ffffff;\">asten<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; background-color: #ffffff;\">{}; &nbsp; &nbsp; &nbsp; &nbsp;<\/span><span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; color: #008000; background-color: #ffffff;\">\/\/ AST Enable Register<\/span><\/p>\n\r<p class=\"p_Normal\"><span style=\"width:3.0000rem;display:inline-block\">&nbsp;<\/span> &nbsp; &nbsp; &nbsp; &nbsp;<span style=\"font-size: 0.82rem; font-family: \'Cascadia Mono\'; background-color: #ffffff;\">asten = 0;<\/span><\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r"
})
