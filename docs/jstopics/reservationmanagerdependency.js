hmLoadTopic({
hmKeywords:"",
hmTitle:"ReservationManager",
hmDescription:"Structural Requirements RM-REQ-001: Provide per-CPU reservation tracking for LL\/SC instructions. RM-REQ-002:  Track the reserved physical address, aligned to a “granule” (32B",
hmPrevLink:"",
hmNextLink:"",
hmParentLink:"appendix---trait-examples.html",
hmBreadCrumbs:"",
hmTitlePath:"ASA-EMulatR Reference Guide > Introduction > Appendix > Appendix I – Glossary and Acronyms",
hmHeader:"<h1 class=\"p_Heading1\" style=\"page-break-after: avoid;\"><span class=\"f_Heading1\">ReservationManager<\/span><\/h1>\n\r",
hmBody:"<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><strong style=\"font-weight: bold;\">Structural Requirements<\/strong><\/p>\n\r<div style=\"text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;\"><table style=\"border:none; border-spacing:0;\">\n\r<tr>\n\r<td style=\"vertical-align:top; width:7.8750rem; padding:0; border:none\"><p class=\"p_Normal\">RM-REQ-001:<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:47.6250rem; padding:0; border:none\"><p class=\"p_Normal\">Provide per-CPU reservation tracking for LL\/SC instructions.<\/p>\n\r<\/td>\n\r<\/tr>\n\r<tr>\n\r<td style=\"vertical-align:top; width:7.8750rem; padding:0; border:none\"><p class=\"p_Normal\">RM-REQ-002: <\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:47.6250rem; padding:0; border:none\"><p class=\"p_Normal\">Track the reserved physical address, aligned to a “granule” (32B EV4 \/ 64B EV6).<\/p>\n\r<\/td>\n\r<\/tr>\n\r<tr>\n\r<td style=\"vertical-align:top; width:7.8750rem; padding:0; border:none\"><p class=\"p_Normal\">RM-REQ-003:<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:47.6250rem; padding:0; border:none\"><p class=\"p_Normal\">One active reservation per CPU at any time.<\/p>\n\r<\/td>\n\r<\/tr>\n\r<tr>\n\r<td style=\"vertical-align:top; width:7.8750rem; padding:0; border:none\"><p class=\"p_Normal\">RM-REQ-004:<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:47.6250rem; padding:0; border:none\"><p class=\"p_Normal\">ReservationStorage must be sized to numCpus (or MAX_CPUS in default mode).<\/p>\n\r<\/td>\n\r<\/tr>\n\r<tr>\n\r<td style=\"vertical-align:top; width:7.8750rem; padding:0; border:none\"><p class=\"p_Normal\">RM-REQ-005:<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:47.6250rem; padding:0; border:none\"><p class=\"p_Normal\">Provide (optional) timestamp metadata per CPU reservation.<\/p>\n\r<\/td>\n\r<\/tr>\n\r<\/table>\n\r<\/div>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><strong style=\"font-weight: bold;\">LL\/SC Functional Requirements<\/strong><\/p>\n\r<div style=\"text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;\"><table style=\"border:none; border-spacing:0;\">\n\r<tr>\n\r<td style=\"vertical-align:top; width:8.5625rem; padding:0; border:none\"><p class=\"p_Normal\">RM-REQ-010:<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:46.9375rem; padding:0; border:none\"><p class=\"p_Normal\">reserve(cpuId, pa) must record the reservation atomically.<\/p>\n\r<\/td>\n\r<\/tr>\n\r<tr>\n\r<td style=\"vertical-align:top; width:8.5625rem; padding:0; border:none\"><p class=\"p_Normal\">RM-REQ-011:<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:46.9375rem; padding:0; border:none\"><p class=\"p_Normal\">tryStoreConditional(cpuId, pa) must succeed only if: The address is in the same granule as the stored reservation. The reservation is valid at the moment of check.<\/p>\n\r<\/td>\n\r<\/tr>\n\r<tr>\n\r<td style=\"vertical-align:top; width:8.5625rem; padding:0; border:none\"><p class=\"p_Normal\">RM-REQ-012:<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:46.9375rem; padding:0; border:none\"><p class=\"p_Normal\">Successful STx_C must invalidate the reservation.<\/p>\n\r<\/td>\n\r<\/tr>\n\r<\/table>\n\r<\/div>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><strong style=\"font-weight: bold;\">Write-Invalidation Requirements<\/strong><\/p>\n\r<div style=\"text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;\"><table style=\"border:none; border-spacing:0;\">\n\r<tr>\n\r<td style=\"vertical-align:top; width:8.5625rem; padding:0; border:none\"><p class=\"p_Normal\">RM-REQ-020:<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:46.9375rem; padding:0; border:none\"><p class=\"p_Normal\">Any write by any CPU to the granule must invalidate all other CPUs’ reservations.<\/p>\n\r<\/td>\n\r<\/tr>\n\r<tr>\n\r<td style=\"vertical-align:top; width:8.5625rem; padding:0; border:none\"><p class=\"p_Normal\">RM-REQ-021:<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:46.9375rem; padding:0; border:none\"><p class=\"p_Normal\">Any DMA \/ device memory write into RAM (via SafeMemory or MMIO DMA path) must trigger invalidation.<\/p>\n\r<\/td>\n\r<\/tr>\n\r<tr>\n\r<td style=\"vertical-align:top; width:8.5625rem; padding:0; border:none\"><p class=\"p_Normal\">RM-REQ-022:<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:46.9375rem; padding:0; border:none\"><p class=\"p_Normal\">Invalidation must be performed under write-lock and be atomic with respect to CPU reservations.<\/p>\n\r<\/td>\n\r<\/tr>\n\r<\/table>\n\r<\/div>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><strong style=\"font-weight: bold;\">Callbacks and Notifications<\/strong><\/p>\n\r<div style=\"text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;\"><table style=\"border:none; border-spacing:0;\">\n\r<tr>\n\r<td style=\"vertical-align:top; width:8.6250rem; padding:0; border:none\"><p class=\"p_Normal\">RM-REQ-030:<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:46.8750rem; padding:0; border:none\"><p class=\"p_Normal\">Provide a callback (m_onInvalidated) invoked whenever a reservation is invalidated.<\/p>\n\r<\/td>\n\r<\/tr>\n\r<tr>\n\r<td style=\"vertical-align:top; width:8.6250rem; padding:0; border:none\"><p class=\"p_Normal\">RM-REQ-031:<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:46.8750rem; padding:0; border:none\"><p class=\"p_Normal\">Callback MUST be invoked after releasing the internal write-lock.<\/p>\n\r<\/td>\n\r<\/tr>\n\r<tr>\n\r<td style=\"vertical-align:top; width:8.6250rem; padding:0; border:none\"><p class=\"p_Normal\">RM-REQ-032:<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:46.8750rem; padding:0; border:none\"><p class=\"p_Normal\">Allow EmulatorManager to attach a callback that sends a reservation-break IPI via IRQController.<\/p>\n\r<\/td>\n\r<\/tr>\n\r<\/table>\n\r<\/div>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><strong style=\"font-weight: bold;\">Context-Switch Requirements<\/strong><\/p>\n\r<div style=\"text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;\"><table style=\"border:none; border-spacing:0;\">\n\r<tr>\n\r<td style=\"vertical-align:top; width:8.6875rem; padding:0; border:none\"><p class=\"p_Normal\">RM-REQ-040:<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:46.8750rem; padding:0; border:none\"><p class=\"p_Normal\">Reservations MUST be cleared when a CPU: Enters PAL code, Exits PAL code, Changes ASN, Changes PCB or kernel thread, Performs REI<\/p>\n\r<\/td>\n\r<\/tr>\n\r<tr>\n\r<td style=\"vertical-align:top; width:8.6875rem; padding:0; border:none\"><p class=\"p_Normal\">RM-REQ-041:<\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:46.8750rem; padding:0; border:none\"><p class=\"p_Normal\">Provide a method clearReservation(cpuId) suitable for PAL handler usage.<\/p>\n\r<\/td>\n\r<\/tr>\n\r<\/table>\n\r<\/div>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">PTE - SPAMShardManager<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r"
})
