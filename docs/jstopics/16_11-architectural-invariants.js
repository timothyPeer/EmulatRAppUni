hmLoadTopic({
hmKeywords:"",
hmTitle:"16.11 Architectural Invariants (Normative)",
hmDescription:"The following invariants govern the device and DMA subsystem. Violation of any invariant constitutes an emulator bug.",
hmPrevLink:"mplatedefault-modified2026-02-.html",
hmNextLink:"16_12-repository-directory-map.html",
hmParentLink:"chapter-16---device-model--dma.html",
hmBreadCrumbs:"<a href=\"license-_-attributions.html\">ASA-EMulatR Reference Guide<\/a> &gt; <a href=\"index.html\">Introduction<\/a> &gt; <a href=\"architecture-overview.html\">Architecture Overview<\/a> &gt; <a href=\"chapter-16---device-model--dma.html\">Chapter 16 – Device Model &amp; DMA<\/a>",
hmTitlePath:"ASA-EMulatR Reference Guide > Introduction > Architecture Overview > Chapter 16 – Device Model & DMA > 16.11 Architectural Invariants (Normative)",
hmHeader:"<h1 class=\"p_Heading1\" style=\"page-break-after: avoid;\"><span class=\"f_Heading1\">16.11 Architectural Invariants (Normative)<\/span><\/h1>\n\r",
hmBody:"<p class=\"p_Normal\">The following invariants govern the device and DMA subsystem. Violation of any invariant constitutes an emulator bug.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><strong style=\"font-weight: bold;\">MMIO Ordering:<\/strong> All MMIO accesses are strongly ordered — no reordering, no buffering, no speculation, no combining. MMIO writes bypass the write buffer and commit synchronously through GuestMemory → MMIOManager → device handler.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><strong style=\"font-weight: bold;\">Device Asynchrony:<\/strong> Device emulators execute I\/O operations asynchronously in dedicated threads. <span class=\"f_CodeExample\">IDeviceEmulator::onRead()<\/span> and <span class=\"f_CodeExample\">onWrite()<\/span> must return immediately and may never block on I\/O. Long-running operations are queued to the device\'s I\/O thread.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><strong style=\"font-weight: bold;\">Endianness Transparency:<\/strong> The CPU and memory system never perform implicit byte swapping. All endianness conversion is the device emulator\'s responsibility. MMIOManager is byte-order-transparent.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><strong style=\"font-weight: bold;\">DMA Routing:<\/strong> All DMA transfers route through GuestMemory with explicit <span class=\"f_CodeExample\">AccessKind::DMARead<\/span> or <span class=\"f_CodeExample\">AccessKind::DMAWrite<\/span> designation. No device may access SafeMemory directly. DMA writes must break overlapping LL\/SC reservations.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><strong style=\"font-weight: bold;\">Interrupt Delivery:<\/strong> Device interrupts are delivered via the <span class=\"f_CodeExample\">coreLib\/<\/span> IRQ system using atomic <span class=\"f_CodeExample\">IRQPendingState<\/span> bitmasks. The hot path (interrupt polling) is lock-free. All device interrupts enter PAL mode for dispatch.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><strong style=\"font-weight: bold;\">Region Immutability:<\/strong> MMIO regions are registered during initialization and locked by <span class=\"f_CodeExample\">MMIOManager::finalize()<\/span>. No regions may be added, removed, or modified at runtime.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><strong style=\"font-weight: bold;\">Device Independence:<\/strong> Device managers are independently instantiable and testable. No device category depends on another device category being functional. Degraded devices are recorded, not fatal.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_SeeAlso\" style=\"page-break-after: avoid;\"><span class=\"f_SeeAlso\">See Also: <a href=\"chapter-11---architectural-inv.html\" class=\"topiclink\">Chapter 11 - Architectural Invariants (complete invariant reference)<\/a>; <a href=\"11_8-device-and-mmio-invariant.html\" class=\"topiclink\">11.8 Device and MMIO Invariants<\/a>.<\/span><\/p>\n\r"
})
