hmLoadTopic({
hmKeywords:"",
hmTitle:"18.10 Architectural Invariants (Normative)",
hmDescription:"The following invariants govern the fault dispatch subsystem. Violation of any invariant constitutes an emulator bug.",
hmPrevLink:"18_9-barrier-interaction.html",
hmNextLink:"18_11-repository-directory-map.html",
hmParentLink:"chapter-18---fault-dispatcher-.html",
hmBreadCrumbs:"<a href=\"license-_-attributions.html\">ASA-EMulatR Reference Guide<\/a> &gt; <a href=\"index.html\">Introduction<\/a> &gt; <a href=\"architecture-overview.html\">Architecture Overview<\/a> &gt; <a href=\"chapter-18---fault-dispatcher-.html\">Chapter 18 – Fault Dispatcher &amp; Precise Exceptions<\/a>",
hmTitlePath:"ASA-EMulatR Reference Guide > Introduction > Architecture Overview > Chapter 18 – Fault Dispatcher & Precise Exceptions > 18.10 Architectural Invariants (Normative)",
hmHeader:"<h1 class=\"p_Heading1\" style=\"page-break-after: avoid;\"><span class=\"f_Heading1\">18.10 Architectural Invariants (Normative)<\/span><\/h1>\n\r",
hmBody:"<p class=\"p_Normal\">The following invariants govern the fault dispatch subsystem. Violation of any invariant constitutes an emulator bug.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><strong style=\"font-weight: bold;\">Precise Delivery:<\/strong> All exceptions are precise. When a fault is delivered, all prior instructions have completed, the faulting instruction is identified (EXC_ADDR), and no later instruction has modified architectural state. Faults detected in EX are not delivered until WB.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><strong style=\"font-weight: bold;\">No Partial Effects:<\/strong> No faulting instruction may partially commit. A faulting store never reaches SafeMemory. A faulting load never writes a result register. The pending commit is discarded in WB before any commit logic runs.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><strong style=\"font-weight: bold;\">Single Authority:<\/strong> FaultDispatcher is the sole authority for event queueing and delivery on its CPU. No other component may deliver exceptions or modify event state. One FaultDispatcher per CPU, accessed via <span class=\"f_CodeExample\">globalFaultDispatcher(cpuId)<\/span>.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><strong style=\"font-weight: bold;\">Classification Consistency:<\/strong> <span class=\"f_CodeExample\">ExceptionFactory<\/span> is the sole constructor for PendingEvent instances. <span class=\"f_CodeExample\">ExceptionMapping_inl::mapClassToPalVector()<\/span> is the single source of truth for ExceptionClass → PalVectorId mapping. No detection point constructs raw PendingEvent or resolves PAL vectors directly.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><strong style=\"font-weight: bold;\">PAL Exclusivity:<\/strong> All exception handlers are PAL code. No exception handler exists outside PAL. All delivery paths converge on <span class=\"f_CodeExample\">enterPalMode()<\/span>.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><strong style=\"font-weight: bold;\">Priority Enforcement:<\/strong> When multiple events are pending, the highest-priority event is delivered first. Lower-priority events remain queued. Interrupts (lowest priority) are never delivered while a synchronous fault is pending.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><strong style=\"font-weight: bold;\">Reservation Clearing:<\/strong> Exception delivery and PAL mode entry clear LL\/SC reservations. No STx_C may succeed across an exception boundary.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><strong style=\"font-weight: bold;\">Hot Path Efficiency:<\/strong> <span class=\"f_CodeExample\">eventPending()<\/span> is a single bitfield test (~1 cycle, no atomics). The FaultDispatcher is per-CPU with no cross-CPU synchronization on the hot path.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_SeeAlso\" style=\"page-break-after: avoid;\"><span class=\"f_SeeAlso\">See Also: <a href=\"chapter-11---architectural-inv.html\" class=\"topiclink\">Chapter 11 - Architectural Invariants<\/a> (complete invariant reference); <a href=\"11_2-execution-and-pipeline-in.html\" class=\"topiclink\">11.2 Execution and Pipeline Invariants<\/a> (precise execution).<\/span><\/p>\n\r"
})
