hmLoadTopic({
hmKeywords:"",
hmTitle:"Specation",
hmDescription:"===============================================================================",
hmPrevLink:"",
hmNextLink:"",
hmParentLink:"appendix---trait-examples.html",
hmBreadCrumbs:"",
hmTitlePath:"Introduction > Appendix > Appendix I â€“ Global Singletons",
hmHeader:"<h1 class=\"p_Heading1\" style=\"page-break-after: avoid;\"><span class=\"f_Heading1\">Specation <\/span><\/h1>\n\r",
hmBody:"<p class=\"p_Normal\">===============================================================================<\/p>\n\r<p class=\"p_Normal\">ALPHA AXP PIPELINE EXECUTION SPECIFICATION<\/p>\n\r<p class=\"p_Normal\">Authoritative Coding Specification (Pipeline-Centric)<\/p>\n\r<p class=\"p_Normal\">===============================================================================<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">1. PURPOSE AND SCOPE<\/p>\n\r<p class=\"p_Normal\">--------------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">This specification defines the authoritative execution model for the Alpha AXP<\/p>\n\r<p class=\"p_Normal\">emulator pipeline. &nbsp;The pipeline is the single source of truth during instruction<\/p>\n\r<p class=\"p_Normal\">execution. &nbsp;AlphaCPU serves as the orchestration and control boundary only.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">This document specifies:<\/p>\n\r<p class=\"p_Normal\">- Required control flow<\/p>\n\r<p class=\"p_Normal\">- Mandatory stage entry\/exit behavior<\/p>\n\r<p class=\"p_Normal\">- Stall and fault semantics<\/p>\n\r<p class=\"p_Normal\">- Box responsibilities<\/p>\n\r<p class=\"p_Normal\">- Precise exception and redo guarantees<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">The specification is pipeline-centric and applies to all instruction classes.<\/p>\n\r<p class=\"p_Normal\">Detailed execution is illustrated using MBox (memory) operations, which subsume<\/p>\n\r<p class=\"p_Normal\">the control requirements of EBox, FBox, CBox, and PalBox.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">-------------------------------------------------------------------------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">2. ARCHITECTURAL ROLES<\/p>\n\r<p class=\"p_Normal\">---------------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">2.1 AlphaCPU<\/p>\n\r<p class=\"p_Normal\">------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">AlphaCPU:<\/p>\n\r<p class=\"p_Normal\">- Owns the run loop<\/p>\n\r<p class=\"p_Normal\">- Owns architectural state (PC, registers, IPRs)<\/p>\n\r<p class=\"p_Normal\">- Owns FaultDispatcher \/ faultSink<\/p>\n\r<p class=\"p_Normal\">- Enters and exits PAL mode<\/p>\n\r<p class=\"p_Normal\">- Does NOT execute instruction semantics<\/p>\n\r<p class=\"p_Normal\">- Does NOT resolve stalls<\/p>\n\r<p class=\"p_Normal\">- Does NOT advance PC speculatively<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">AlphaCPU SHALL:<\/p>\n\r<p class=\"p_Normal\">- Call IBox::stepPipeline()<\/p>\n\r<p class=\"p_Normal\">- Call Pipeline::step()<\/p>\n\r<p class=\"p_Normal\">- Observe pipeline termination conditions<\/p>\n\r<p class=\"p_Normal\">- Deliver pending faults into PAL<\/p>\n\r<p class=\"p_Normal\">- Resume execution at the PC specified by the architecture<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">2.2 IBox (Frontend)<\/p>\n\r<p class=\"p_Normal\">-------------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">IBox:<\/p>\n\r<p class=\"p_Normal\">- Fetches instruction grains<\/p>\n\r<p class=\"p_Normal\">- Performs ITB translation for fetch<\/p>\n\r<p class=\"p_Normal\">- Performs decode cache lookup<\/p>\n\r<p class=\"p_Normal\">- Produces FetchResult objects<\/p>\n\r<p class=\"p_Normal\">- Never commits architectural state<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">IBox SHALL:<\/p>\n\r<p class=\"p_Normal\">- Respect frontend stall indications<\/p>\n\r<p class=\"p_Normal\">- Stop fetching immediately on stall or fault<\/p>\n\r<p class=\"p_Normal\">- Return control to AlphaCPU without side effects<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">2.3 AlphaPipeline (Authoritative Execution Engine)<\/p>\n\r<p class=\"p_Normal\">--------------------------------------------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">The pipeline:<\/p>\n\r<p class=\"p_Normal\">- Is the sole authority for instruction progression<\/p>\n\r<p class=\"p_Normal\">- Owns PipelineSlot state<\/p>\n\r<p class=\"p_Normal\">- Owns stall and fault propagation<\/p>\n\r<p class=\"p_Normal\">- Determines whether instructions retire, stall, or fault<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">No other component may override pipeline decisions.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">-------------------------------------------------------------------------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">3. PIPELINE CONTROL INVARIANTS<\/p>\n\r<p class=\"p_Normal\">-----------------------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">INV-1: The pipeline is the source of truth for instruction state.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">INV-2: A faulting instruction MUST NOT retire.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">INV-3: On synchronous fault, the architectural PC MUST remain at the faulting<\/p>\n\r<p class=\"p_Normal\"> &nbsp; &nbsp; &nbsp; instruction.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">INV-4: Redo semantics are mandatory for ITB\/DTB misses.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">INV-5: A stall is a microarchitectural condition; a fault is an architectural<\/p>\n\r<p class=\"p_Normal\"> &nbsp; &nbsp; &nbsp; condition. &nbsp;They MUST NOT be conflated.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">INV-6: Boxes may detect faults but may not advance PC or retire instructions.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">-------------------------------------------------------------------------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">4. PIPELINE SLOT STATE<\/p>\n\r<p class=\"p_Normal\">---------------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Each PipelineSlot SHALL contain, at minimum:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">- valid &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : instruction present<\/p>\n\r<p class=\"p_Normal\">- stalled &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : microarchitectural stall latch<\/p>\n\r<p class=\"p_Normal\">- faultPending &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: architectural fault latch<\/p>\n\r<p class=\"p_Normal\">- execUnit &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: EBox \/ FBox \/ MBox \/ CBox \/ PalBox<\/p>\n\r<p class=\"p_Normal\">- needsWriteback &nbsp; &nbsp; &nbsp; &nbsp;: indicates architectural result<\/p>\n\r<p class=\"p_Normal\">- payload &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : computed result (if any)<\/p>\n\r<p class=\"p_Normal\">- memResultValid &nbsp; &nbsp; &nbsp; &nbsp;: memory result latch<\/p>\n\r<p class=\"p_Normal\">- stagedITB \/ stagedDTB : speculative PTE artifacts<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Rules:<\/p>\n\r<p class=\"p_Normal\">- faultPending dominates stalled<\/p>\n\r<p class=\"p_Normal\">- faultPending MUST be sticky until consumed by AlphaCPU<\/p>\n\r<p class=\"p_Normal\">- stalled MUST block advancement but not raise PAL<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">-------------------------------------------------------------------------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">5. FRONTEND STALL SEMANTICS<\/p>\n\r<p class=\"p_Normal\">--------------------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Frontend stall is a derived condition and SHALL be computed as:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">FrontendStalled :=<\/p>\n\r<p class=\"p_Normal\"> &nbsp; &nbsp;stage(0).valid &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;OR<\/p>\n\r<p class=\"p_Normal\"> &nbsp; &nbsp;stage(1).stalled &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;OR<\/p>\n\r<p class=\"p_Normal\"> &nbsp; &nbsp;stage(2).stalled &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;OR<\/p>\n\r<p class=\"p_Normal\"> &nbsp; &nbsp;stage(3).stalled &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;OR<\/p>\n\r<p class=\"p_Normal\"> &nbsp; &nbsp;stage(4).stalled &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;OR<\/p>\n\r<p class=\"p_Normal\"> &nbsp; &nbsp;stage(5).stalled<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">If FrontendStalled is true:<\/p>\n\r<p class=\"p_Normal\">- IBox SHALL NOT fetch<\/p>\n\r<p class=\"p_Normal\">- No new FetchResult SHALL be consumed<\/p>\n\r<p class=\"p_Normal\">- Pipeline SHALL continue resolving internal stalls<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Frontend stall does NOT:<\/p>\n\r<p class=\"p_Normal\">- Raise faults<\/p>\n\r<p class=\"p_Normal\">- Enter PAL<\/p>\n\r<p class=\"p_Normal\">- Flush pipeline<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">-------------------------------------------------------------------------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">6. FAULT SEMANTICS<\/p>\n\r<p class=\"p_Normal\">-----------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Faults are architectural and synchronous.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">6.1 Fault Detection<\/p>\n\r<p class=\"p_Normal\">-------------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Any box detecting a fault SHALL:<\/p>\n\r<p class=\"p_Normal\">- Set slot.faultPending = true<\/p>\n\r<p class=\"p_Normal\">- Populate faultSink with a PendingEvent<\/p>\n\r<p class=\"p_Normal\">- Return immediately<\/p>\n\r<p class=\"p_Normal\">- Perform NO further semantic work<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">This includes:<\/p>\n\r<p class=\"p_Normal\">- EA calculation failure<\/p>\n\r<p class=\"p_Normal\">- Alignment faults<\/p>\n\r<p class=\"p_Normal\">- ITB\/DTB miss<\/p>\n\r<p class=\"p_Normal\">- Access violation<\/p>\n\r<p class=\"p_Normal\">- Memory bus error<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">6.2 Fault Propagation<\/p>\n\r<p class=\"p_Normal\">--------------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Once slot.faultPending is set:<\/p>\n\r<p class=\"p_Normal\">- No further pipeline advancement SHALL occur<\/p>\n\r<p class=\"p_Normal\">- No retirement SHALL occur<\/p>\n\r<p class=\"p_Normal\">- Younger slots SHALL be flushed<\/p>\n\r<p class=\"p_Normal\">- Pipeline::step() SHALL terminate immediately<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">6.3 Fault Consumption<\/p>\n\r<p class=\"p_Normal\">--------------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">AlphaCPU SHALL:<\/p>\n\r<p class=\"p_Normal\">- Observe faultPending via pipeline return status<\/p>\n\r<p class=\"p_Normal\">- Enter PAL<\/p>\n\r<p class=\"p_Normal\">- Resume execution at the architectural continuation PC<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">-------------------------------------------------------------------------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">7. PIPELINE STEP CONTRACT<\/p>\n\r<p class=\"p_Normal\">-------------------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Pipeline::step() represents ONE PIPELINE CYCLE.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Pipeline::step() SHALL:<\/p>\n\r<p class=\"p_Normal\">1. Execute stages in reverse order: WB -&gt; MEM -&gt; EX -&gt; IS -&gt; DE -&gt; IF<\/p>\n\r<p class=\"p_Normal\">2. Abort immediately if faultPending is observed<\/p>\n\r<p class=\"p_Normal\">3. Block advancement if any stage is stalled<\/p>\n\r<p class=\"p_Normal\">4. Advance the ring ONLY if no stall and no fault<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Pipeline::step() SHALL return control to AlphaCPU after:<\/p>\n\r<p class=\"p_Normal\">- Fault detection<\/p>\n\r<p class=\"p_Normal\">- Stall resolution<\/p>\n\r<p class=\"p_Normal\">- Retirement<\/p>\n\r<p class=\"p_Normal\">- Idle cycle<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">-------------------------------------------------------------------------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">8. STAGE SPECIFICATIONS<\/p>\n\r<p class=\"p_Normal\">----------------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">8.1 STAGE WB (Writeback \/ Retirement)<\/p>\n\r<p class=\"p_Normal\">-------------------------------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Responsibilities:<\/p>\n\r<p class=\"p_Normal\">- Detect retirement eligibility<\/p>\n\r<p class=\"p_Normal\">- Commit architectural state<\/p>\n\r<p class=\"p_Normal\">- Advance PC exactly once per retired instruction<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Rules:<\/p>\n\r<p class=\"p_Normal\">- If slot.faultPending == true:<\/p>\n\r<p class=\"p_Normal\"> &nbsp; &nbsp;- Clear slot<\/p>\n\r<p class=\"p_Normal\"> &nbsp; &nbsp;- Return immediately<\/p>\n\r<p class=\"p_Normal\">- If needsWriteback == true:<\/p>\n\r<p class=\"p_Normal\"> &nbsp; &nbsp;- Commit payload to FP or INT register<\/p>\n\r<p class=\"p_Normal\">- Advance PC ONLY here<\/p>\n\r<p class=\"p_Normal\">- Clear slot.valid after retirement<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">8.2 STAGE MEM (Memory Phase 2)<\/p>\n\r<p class=\"p_Normal\">------------------------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Responsibilities:<\/p>\n\r<p class=\"p_Normal\">- Perform physical memory access<\/p>\n\r<p class=\"p_Normal\">- Finalize load\/store results<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Rules:<\/p>\n\r<p class=\"p_Normal\">- If stalled: hold state<\/p>\n\r<p class=\"p_Normal\">- If faultPending: propagate upward<\/p>\n\r<p class=\"p_Normal\">- Loads set memResultValid<\/p>\n\r<p class=\"p_Normal\">- Stores perform commit or fault<\/p>\n\r<p class=\"p_Normal\">- No PC updates allowed<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">8.3 STAGE EX (Execution)<\/p>\n\r<p class=\"p_Normal\">------------------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Responsibilities:<\/p>\n\r<p class=\"p_Normal\">- Dispatch to execution box<\/p>\n\r<p class=\"p_Normal\">- Perform semantic execution<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">For MBox:<\/p>\n\r<p class=\"p_Normal\">- Calculate effective address<\/p>\n\r<p class=\"p_Normal\">- Perform DTB translation<\/p>\n\r<p class=\"p_Normal\">- Stage PTEs<\/p>\n\r<p class=\"p_Normal\">- Detect faults<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Rules:<\/p>\n\r<p class=\"p_Normal\">- On fault: set faultPending and return<\/p>\n\r<p class=\"p_Normal\">- On stall (e.g., resource busy): set stalled<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">8.4 STAGE IS (Issue)<\/p>\n\r<p class=\"p_Normal\">--------------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Responsibilities:<\/p>\n\r<p class=\"p_Normal\">- Detect register hazards<\/p>\n\r<p class=\"p_Normal\">- Perform scoreboard updates<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Rules:<\/p>\n\r<p class=\"p_Normal\">- On hazard: set stalled<\/p>\n\r<p class=\"p_Normal\">- Do not advance on stall<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">8.5 STAGE DE (Decode)<\/p>\n\r<p class=\"p_Normal\">---------------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Responsibilities:<\/p>\n\r<p class=\"p_Normal\">- Decode instruction format<\/p>\n\r<p class=\"p_Normal\">- Extract operands<\/p>\n\r<p class=\"p_Normal\">- Determine execUnit<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Rules:<\/p>\n\r<p class=\"p_Normal\">- No architectural side effects<\/p>\n\r<p class=\"p_Normal\">- Decode MUST precede execution<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">8.6 STAGE IF (Fetch Injection)<\/p>\n\r<p class=\"p_Normal\">------------------------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Responsibilities:<\/p>\n\r<p class=\"p_Normal\">- Consume FetchResult<\/p>\n\r<p class=\"p_Normal\">- Populate slot(0)<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Rules:<\/p>\n\r<p class=\"p_Normal\">- If frontend stalled: do nothing<\/p>\n\r<p class=\"p_Normal\">- If faultPending: do nothing<\/p>\n\r<p class=\"p_Normal\">- Advance ring ONLY if slot accepted<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">-------------------------------------------------------------------------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">9. MBOX EXECUTION (REFERENCE MODEL)<\/p>\n\r<p class=\"p_Normal\">----------------------------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">MBox is the reference execution model.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">MBox SHALL:<\/p>\n\r<p class=\"p_Normal\">- Read operand values from AlphaProcessorContext<\/p>\n\r<p class=\"p_Normal\">- Never treat register indices as values<\/p>\n\r<p class=\"p_Normal\">- Use staged DTB PTEs if present<\/p>\n\r<p class=\"p_Normal\">- Perform SPAM lookup if not staged<\/p>\n\r<p class=\"p_Normal\">- Set slot.stalled on retryable conditions<\/p>\n\r<p class=\"p_Normal\">- Set slot.faultPending on faults<\/p>\n\r<p class=\"p_Normal\">- Never advance PC<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">All memory faults MUST be precise and restartable.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">-------------------------------------------------------------------------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">10. PAL AND CONTROL FLOW<\/p>\n\r<p class=\"p_Normal\">-----------------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">- PAL entry is initiated ONLY by AlphaCPU<\/p>\n\r<p class=\"p_Normal\">- Pipeline MUST quiesce before PAL<\/p>\n\r<p class=\"p_Normal\">- Continuation PC MUST point to faulting instruction<\/p>\n\r<p class=\"p_Normal\">- On PAL return, pipeline restarts at that PC<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">-------------------------------------------------------------------------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">11. REQUIRED PIPELINE CHANGES (ASSESSMENT)<\/p>\n\r<p class=\"p_Normal\">------------------------------------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Based on current implementation, the following changes are REQUIRED:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">- Pipeline::step() must return immediately on faultPending<\/p>\n\r<p class=\"p_Normal\">- advanceRing() must be conditional<\/p>\n\r<p class=\"p_Normal\">- PC advancement must exist ONLY in WB<\/p>\n\r<p class=\"p_Normal\">- faultPending must be set by all faulting boxes<\/p>\n\r<p class=\"p_Normal\">- stalled must block advancement but not raise PAL<\/p>\n\r<p class=\"p_Normal\">- Frontend stall must be consumed by AlphaCPU\/IBox<\/p>\n\r<p class=\"p_Normal\">- MBox must read register values, not indices<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">-------------------------------------------------------------------------------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">12. SUMMARY<\/p>\n\r<p class=\"p_Normal\">-----------<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">This specification establishes a strict, pipeline-authoritative execution model.<\/p>\n\r<p class=\"p_Normal\">All boxes operate as semantic engines only. &nbsp;All control decisions flow through<\/p>\n\r<p class=\"p_Normal\">the pipeline and terminate in the AlphaCPU run loop.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">MBox execution fully exercises this model; correctness here implies correctness<\/p>\n\r<p class=\"p_Normal\">for all other boxes.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">===============================================================================<\/p>\n\r<p class=\"p_Normal\">END OF SPECIFICATION<\/p>\n\r<p class=\"p_Normal\">===============================================================================<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r"
})
