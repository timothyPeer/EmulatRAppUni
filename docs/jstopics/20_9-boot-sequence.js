hmLoadTopic({
hmKeywords:"",
hmTitle:"20.9 Boot Sequence",
hmDescription:"20.9.1 Phase 0 — Static Construction  Before any CPU runs, all global subsystems are constructed: GuestMemory (physical RAM allocated, MMIO regions registered, reservation...",
hmPrevLink:"20_8-cserve-and-srm-console-in.html",
hmNextLink:"20_10-architectural-invariants.html",
hmParentLink:"chapter-20---boot-sequence_-pa.html",
hmBreadCrumbs:"<a href=\"license-_-attributions.html\">ASA-EMulatR Reference Guide<\/a> &gt; <a href=\"index.html\">Introduction<\/a> &gt; <a href=\"architecture-overview.html\">Architecture Overview<\/a> &gt; <a href=\"chapter-20---boot-sequence_-pa.html\">Chapter 20 – Boot Sequence, PAL, and SRM Integration<\/a>",
hmTitlePath:"ASA-EMulatR Reference Guide > Introduction > Architecture Overview > Chapter 20 – Boot Sequence, PAL, and SRM Integration > 20.9 Boot Sequence",
hmHeader:"<h1 class=\"p_Heading1\" style=\"page-break-after: avoid;\"><span class=\"f_Heading1\">20.9 Boot Sequence<\/span><\/h1>\n\r",
hmBody:"<h2 class=\"p_Heading2\" style=\"page-break-after: avoid;\"><span class=\"f_Heading2\">20.9.1 Phase 0 — Static Construction<\/span><\/h2>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Before any CPU runs, all global subsystems are constructed: GuestMemory (physical RAM allocated, MMIO regions registered, reservation system initialized), MMIO and devices (ConsoleOPA0Device, ConsoleManager, SRMEnvStore), interrupt infrastructure (IRQPendingState per CPU, IPIManager, IPIMailboxes), PAL infrastructure (PalVectorTable constructed and initialized, all PAL vectors registered), and CPU objects (AlphaCPU instances, pipeline, register files, FaultDispatcher per CPU, HWPCBBank initialized).<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<hr style=\"height:1px; color:#000000; border-width:0; background-color:#000000;\" \/><p class=\"p_Normal\">&nbsp;<\/p>\n\r<h2 class=\"p_Heading2\" style=\"page-break-after: avoid;\"><span class=\"f_Heading2\">20.9.2 Phase 1 — RESET Vector Entry<\/span><\/h2>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">CPU 0 begins execution at the RESET vector (PAL_BASE + 0x0000). Initial state: PC = RESET vector | 0x1 (PAL mode), IPL = 7, CM = KERNEL, PAL_BASE = 0x0000000000000000 (per EV6 HRM section 4.1.1). The RESET handler initializes core IPRs, sets up the initial page table base (PTBR), initializes the system control block base (SCBB), and prepares the HWPCB for CPU 0.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<hr style=\"height:1px; color:#000000; border-width:0; background-color:#000000;\" \/><p class=\"p_Normal\">&nbsp;<\/p>\n\r<h2 class=\"p_Heading2\" style=\"page-break-after: avoid;\"><span class=\"f_Heading2\">20.9.3 Phase 2 — PAL Initialization<\/span><\/h2>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">PAL code initializes IPRs, TLBs, and caches. Interrupt vectors are configured. The HWRPB (Hardware Restart Parameter Block) is populated with system configuration data (processor type EV6 21264, clock speed, memory size, cache size). Memory regions are established:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">GuestMemory&nbsp;routing:<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">&nbsp;SafeMemory&nbsp;(RAM)&nbsp;0x0_0000_0000&nbsp;–&nbsp;0x1_0000_0000&nbsp;(4&nbsp;GB)<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">&nbsp;MMIOManager&nbsp;(devices)&nbsp;0x1_0000_0000&nbsp;–&nbsp;0x2_0000_0000&nbsp;(4&nbsp;GB)<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">&nbsp;AlphaMemorySystem&nbsp;(PAL)&nbsp;0x2_0000_0000&nbsp;–&nbsp;0x2_0010_0000&nbsp;(1&nbsp;MB)<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">&nbsp;SRMFirmwareRegion&nbsp;(SRM)&nbsp;0x2_0010_0000&nbsp;–&nbsp;0x2_0030_0000&nbsp;(2&nbsp;MB)<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">&nbsp;AlphaMemorySystem&nbsp;(HWRPB)&nbsp;0x2_0030_0000&nbsp;–&nbsp;0x2_0040_0000&nbsp;(1&nbsp;MB)<\/span><\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<hr style=\"height:1px; color:#000000; border-width:0; background-color:#000000;\" \/><p class=\"p_Normal\">&nbsp;<\/p>\n\r<h2 class=\"p_Heading2\" style=\"page-break-after: avoid;\"><span class=\"f_Heading2\">20.9.4 Phase 3 — SRM Console<\/span><\/h2>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Control transfers to the SRM firmware. SRM performs memory testing, displays system identification (processor type, memory size, cache size, serial number), and enters the interactive console loop. SRM uses CSERVE for all I\/O — PUTC\/PUTS for output, GETC\/POLL for input, GETENV\/SETENV for configuration. The console prompt (<span class=\"f_CodeExample\">&gt;&gt;&gt;<\/span>) indicates readiness for commands.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Key SRM environment variables: <span class=\"f_CodeExample\">bootdef_dev<\/span> (default boot device), <span class=\"f_CodeExample\">boot_osflags<\/span> (OS boot flags), <span class=\"f_CodeExample\">boot_file<\/span> (boot file path), <span class=\"f_CodeExample\">auto_action<\/span> (automatic boot action), <span class=\"f_CodeExample\">console<\/span> (console device).<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<hr style=\"height:1px; color:#000000; border-width:0; background-color:#000000;\" \/><p class=\"p_Normal\">&nbsp;<\/p>\n\r<h2 class=\"p_Heading2\" style=\"page-break-after: avoid;\"><span class=\"f_Heading2\">20.9.5 Phase 4 — OS Boot<\/span><\/h2>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">When the user issues a <span class=\"f_CodeExample\">BOOT<\/span> command (or <span class=\"f_CodeExample\">auto_action<\/span> triggers automatic boot), SRM loads the primary bootstrap from the boot device, loads the secondary bootstrap, and transfers control to the operating system. The OS then uses CALL_PAL for system services and takes full control of the hardware via PAL.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_SeeAlso\" style=\"page-break-after: avoid;\"><span class=\"f_SeeAlso\">See Also: <a href=\"chapter-15---memory-system-imp.html\" class=\"topiclink\">Chapter 15 – Memory System Implementation Details<\/a> &nbsp;(GuestMemory routing); <a href=\"chapter-16---device-model--dma.html\" class=\"topiclink\">Chapter 16 – Device Model &amp; DMA<\/a> (ConsoleOPA0Device, SRMEnvStore).<\/span><\/p>\n\r"
})
