hmLoadTopic({
hmKeywords:"",
hmTitle:"9.9 Reservation Invalidation in SMP",
hmDescription:"LL\/SC reservation correctness in SMP depends on the ReservationManager\'s global scanning behavior. When any CPU commits a store in WB stage, CBox calls...",
hmPrevLink:"chapter-9_8-inter-processor-in.html",
hmNextLink:"9_10-barriers-in-smp-context.html",
hmParentLink:"chapter9-smparchitecture.html",
hmBreadCrumbs:"<a href=\"license-_-attributions.html\">ASA-EMulatR Reference Guide<\/a> &gt; <a href=\"index.html\">Introduction<\/a> &gt; <a href=\"architecture-overview.html\">Architecture Overview<\/a> &gt; <a href=\"chapter9-smparchitecture.html\">Chapter 9 - SMP Architecture<\/a>",
hmTitlePath:"ASA-EMulatR Reference Guide > Introduction > Architecture Overview > Chapter 9 - SMP Architecture > 9.9 Reservation Invalidation in SMP",
hmHeader:"<h1 class=\"p_Heading1\" style=\"page-break-after: avoid;\"><span class=\"f_Heading1\">9.9 Reservation Invalidation in SMP<\/span><\/h1>\n\r",
hmBody:"<p class=\"p_Normal\">LL\/SC reservation correctness in SMP depends on the ReservationManager\'s global scanning behavior. When any CPU commits a store in WB stage, CBox calls breakReservationsOnCacheLine(physAddr), which scans all active CPU reservation slots — not just the local CPU\'s. If any other CPU holds a reservation on the same cache line (64-byte aligned), that reservation is cleared.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Additional clearing conditions in SMP:<\/p>\n\r<p class=\"p_Normal\" style=\"text-indent: 0; padding-left: 0.8125rem; margin-left: 0;\"><span class=\"f_Normal\" style=\"font-family: Arial,\'Lucida Sans Unicode\',\'Lucida Grande\',\'Lucida Sans\';display:inline-block;width:0.8125rem;margin-left:-0.8125rem\">&#8226;<\/span>Local store to same cache line — breaks own reservation<\/p>\n\r<p class=\"p_Normal\" style=\"text-indent: 0; padding-left: 0.8125rem; margin-left: 0;\"><span class=\"f_Normal\" style=\"font-family: Arial,\'Lucida Sans Unicode\',\'Lucida Grande\',\'Lucida Sans\';display:inline-block;width:0.8125rem;margin-left:-0.8125rem\">&#8226;<\/span>Remote store to same cache line — breaks remote CPU\'s reservation via breakReservationsOnCacheLine()<\/p>\n\r<p class=\"p_Normal\" style=\"text-indent: 0; padding-left: 0.8125rem; margin-left: 0;\"><span class=\"f_Normal\" style=\"font-family: Arial,\'Lucida Sans Unicode\',\'Lucida Grande\',\'Lucida Sans\';display:inline-block;width:0.8125rem;margin-left:-0.8125rem\">&#8226;<\/span>Barrier execution — MB may break reservations as part of write buffer draining<\/p>\n\r<p class=\"p_Normal\" style=\"text-indent: 0; padding-left: 0.8125rem; margin-left: 0;\"><span class=\"f_Normal\" style=\"font-family: Arial,\'Lucida Sans Unicode\',\'Lucida Grande\',\'Lucida Sans\';display:inline-block;width:0.8125rem;margin-left:-0.8125rem\">&#8226;<\/span>PAL entry\/exit — clears the local CPU\'s reservation only<\/p>\n\r<p class=\"p_Normal\" style=\"text-indent: 0; padding-left: 0.8125rem; margin-left: 0;\"><span class=\"f_Normal\" style=\"font-family: Arial,\'Lucida Sans Unicode\',\'Lucida Grande\',\'Lucida Sans\';display:inline-block;width:0.8125rem;margin-left:-0.8125rem\">&#8226;<\/span>Exception\/interrupt delivery — clears the local CPU\'s reservation only<\/p>\n\r<p class=\"p_Normal\" style=\"text-indent: 0; padding-left: 0.8125rem; margin-left: 0;\"><span class=\"f_Normal\" style=\"font-family: Arial,\'Lucida Sans Unicode\',\'Lucida Grande\',\'Lucida Sans\';display:inline-block;width:0.8125rem;margin-left:-0.8125rem\">&#8226;<\/span>Pipeline flush — clears the local CPU\'s reservation<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">This ensures correctness without locking — LL\/SC uses optimistic concurrency where the common case (no contention) succeeds with zero coordination overhead, and the contention case fails safely.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_SeeAlso\" style=\"page-break-after: avoid;\"><span class=\"f_SeeAlso\">See Also: Section 5.11 – Load-Locked \/ Store-Conditional; cpuCoreLib\/ReservationManager.h.<\/span><\/p>\n\r"
})
