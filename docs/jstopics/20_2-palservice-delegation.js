hmLoadTopic({
hmKeywords:"",
hmTitle:"20.2 PalService Delegation",
hmDescription:"PalBox delegates most implementation to PalService (owned via std::unique_ptr<PalService>). PalBox methods follow a uniform pattern:",
hmPrevLink:"20_1-palbox-execution-domain.html",
hmNextLink:"20_3-call_pal-dispatch-and-vec.html",
hmParentLink:"chapter-20---boot-sequence_-pa.html",
hmBreadCrumbs:"<a href=\"index.html\">Introduction<\/a> &gt; <a href=\"architecture-overview.html\">Architecture Overview<\/a> &gt; <a href=\"chapter-20---boot-sequence_-pa.html\">Chapter 20 – Boot Sequence, PAL, and SRM Integration<\/a>",
hmTitlePath:"Introduction > Architecture Overview > Chapter 20 – Boot Sequence, PAL, and SRM Integration > 20.2 PalService Delegation",
hmHeader:"<h1 class=\"p_Heading1\" style=\"page-break-after: avoid;\"><span class=\"f_Heading1\">20.2 PalService Delegation<\/span><\/h1>\n\r",
hmBody:"<p class=\"p_Normal\">PalBox delegates most implementation to <span class=\"f_CodeExample\">PalService<\/span> (owned via <span class=\"f_CodeExample\">std::unique_ptr&lt;PalService&gt;<\/span>). PalBox methods follow a uniform pattern:<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">\/\/&nbsp;PalBox&nbsp;dispatch&nbsp;pattern<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">BoxResult&nbsp;PalBox::executeXXX(PipelineSlot&amp;&nbsp;slot)&nbsp;{<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">&nbsp;m_palService-&gt;executeXXX(slot,&nbsp;slot.palResult);<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">&nbsp;commitPalResult(slot);<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">&nbsp;return&nbsp;applyBoxResult(slot);<\/span><\/p>\n\r<p class=\"p_CodeExample\"><span class=\"f_CodeExample\">}<\/span><\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><span class=\"f_CodeExample\">PalService<\/span> (<span class=\"f_CodeExample\">palLib_EV6\/Pal_Service.h<\/span>) contains the actual PAL operation implementations. It holds references to the IPR storage, register files, GuestMemory, IRQPendingState, and InterruptRouter needed to implement privileged operations. The separation between PalBox (dispatch and pipeline integration) and PalService (implementation logic) allows PalService to be tested independently of the pipeline.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">PalBox also holds references to <span class=\"f_CodeExample\">IRQPendingState<\/span> and <span class=\"f_CodeExample\">InterruptRouter<\/span> for interrupt delivery coordination. The <span class=\"f_CodeExample\">commitPalResult()<\/span> method writes the PAL return value to the destination register after PAL call completion. The <span class=\"f_CodeExample\">contextSwitch(cpuId)<\/span> method breaks the LL\/SC reservation for the specified CPU — the minimal reservation-clearing action required for a context switch.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_SeeAlso\" style=\"page-break-after: avoid;\"><span class=\"f_SeeAlso\">See Also: palLib_EV6\/Pal_Service.h – PalService class; palLib_EV6\/Pal_core_inl.h – PAL core inline helpers; palLib_EV6\/PAL_core.h – PAL constants.<\/span><\/p>\n\r"
})
