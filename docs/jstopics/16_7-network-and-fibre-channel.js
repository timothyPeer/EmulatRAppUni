hmLoadTopic({
hmKeywords:"",
hmTitle:"16.7 Network and Fibre Channel Devices",
hmDescription:"16.7.1 Network Adapter Emulation  Network interface emulation presents a PCI NIC to the guest OS with standard MMIO-mapped control registers, a DMA-based packet transmit\/receive",
hmPrevLink:"16_6-tape-drive-emulation-and-.html",
hmNextLink:"16_8-irq-integration-architect.html",
hmParentLink:"chapter-16---device-model--dma.html",
hmBreadCrumbs:"<a href=\"license-_-attributions.html\">ASA-EMulatR Reference Guide<\/a> &gt; <a href=\"index.html\">Introduction<\/a> &gt; <a href=\"architecture-overview.html\">Architecture Overview<\/a> &gt; <a href=\"chapter-16---device-model--dma.html\">Chapter 16 – Device Model &amp; DMA<\/a>",
hmTitlePath:"ASA-EMulatR Reference Guide > Introduction > Architecture Overview > Chapter 16 – Device Model & DMA > 16.7 Network and Fibre Channel Devices",
hmHeader:"<h1 class=\"p_Heading1\" style=\"page-break-after: avoid;\"><span class=\"f_Heading1\">16.7 Network and Fibre Channel Devices<\/span><\/h1>\n\r",
hmBody:"<h2 class=\"p_Heading2\" style=\"page-break-after: avoid;\"><span class=\"f_Heading2\">16.7.1 Network Adapter Emulation<\/span><\/h2>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Network interface emulation presents a PCI NIC to the guest OS with standard MMIO-mapped control registers, a DMA-based packet transmit\/receive path, and interrupt-driven completion. The guest network driver (e.g., <span class=\"f_CodeExample\">de<\/span> for DEC Tulip-family NICs, <span class=\"f_CodeExample\">tu<\/span> for TURBOchannel Ethernet) interacts with the emulated NIC through the same register interface it would use on real hardware.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">The <span class=\"f_CodeExample\">NetworkManager<\/span> handles adapter lifecycle, MAC address assignment (from configuration), and the host-side network backend binding. Network I\/O operates asynchronously: packet transmit is queued from an MMIO doorbell write and performed by the device\'s I\/O thread; packet receive is driven by the host network backend notifying the device thread, which writes packet data into GuestMemory via DMA and asserts a receive interrupt.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">Endianness is a particular concern for network devices. Network protocol headers (Ethernet, IP, TCP\/UDP) use big-endian (network byte order), while PCI control registers are little-endian. The NIC emulator must handle both byte orders: DMA packet buffers are transferred in network byte order (the guest driver handles ntohl\/ntohs conversion), while register reads and writes use little-endian PCI conventions.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<hr style=\"height:1px; color:#000000; border-width:0; background-color:#000000;\" \/><p class=\"p_Normal\">&nbsp;<\/p>\n\r<h2 class=\"p_Heading2\" style=\"page-break-after: avoid;\"><span class=\"f_Heading2\">16.7.2 Fibre Channel and FG Storage<\/span><\/h2>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">The <span class=\"f_CodeExample\">FibreDeviceManager<\/span> emulates Fibre Channel HBA controllers that present FC-attached storage LUNs to the guest OS. The FC emulation layer handles FLOGI (fabric login), PLOGI (port login), and PRLI (process login) sequences during guest-side fabric discovery. FCP (Fibre Channel Protocol) commands are the FC equivalent of SCSI CDBs — the guest SCSI driver submits commands through the FC transport, and the HBA translates them into FCP information units.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\">FC frame headers are big-endian per the FC-FS specification. The HBA controller emulator handles frame header byte swapping internally, presenting FCP command results through the standard DMA and interrupt path. Backing storage for FC LUNs uses the same RAW partition or file system container strategies described in 16.1.3.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_Normal\"><strong style=\"font-weight: bold;\">Implementation Status:<\/strong> The FibreDeviceManager structure and FC port login sequences are scaffolded. FCP command dispatch to backing storage is functional for basic SCSI read\/write operations. Extended FC operations (RSCN fabric notifications, LIP loop initialization, multi-path I\/O) are not yet implemented.<\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<p class=\"p_SeeAlso\" style=\"page-break-after: avoid;\"><span class=\"f_SeeAlso\">See Also: <a href=\"chapter-10---devices-and-mmio.html\" class=\"topiclink\">Chapter 10 – Devices and Memory-Mapped I\/O (MMIO) (device model overview)<\/a>; mmioLib\/mmio_DMACoherencyManager.h (~579 lines) – DMA coherency for device data transfers.<\/span><\/p>\n\r"
})
